;
(self.AMP=self.AMP||[]).push({m:1,v:"2205120110001",n:"amp-image-lightbox",ev:"0.1",l:!0,f:function(t,i){(()=>{var i;function s(){return i||(i=Promise.resolve(void 0))}var h=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:n}=Array;function e(t,i){const s=[];let h=0;for(let n=0;n<t.length;n++){const e=t[n];i(e,n,t)?s.push(e):(h<n&&(t[h]=e),h++)}return h<t.length&&(t.length=h),s}function r(t){return"string"==typeof t}var{hasOwnProperty:o,toString:a}=Object.prototype;function c(t,i,s,h){return n=>u.solveYValueFromXValue(n,0,0,t,i,s,h,1,1)}var u=class{static solveYValueFromXValue(t,i,s,h,n,e,r,o,a){return u.rr(u.hr(t,i,h,e,o),s,n,r,a)}static hr(t,i,s,h,n){const e=1e-6;let r=(t-i)/(n-i);if(r<=0)return 0;if(r>=1)return 1;let o=0,a=1,c=0;for(let l=0;l<8;l++){c=u.ur(r,i,s,h,n);const l=(u.ur(r+e,i,s,h,n)-c)/e;if(Math.abs(c-t)<e)return r;if(Math.abs(l)<e)break;c<t?o=r:a=r,r-=(c-t)/l}for(let l=0;Math.abs(c-t)>e&&l<8;l++)c<t?(o=r,r=(r+a)/2):(a=r,r=(r+o)/2),c=u.ur(r,i,s,h,n);return r}static ur(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=u.lr(i,s,t),r=u.lr(s,h,t);const o=u.lr(h,n,t);return e=u.lr(e,r,t),r=u.lr(r,o,t),u.lr(e,r,t)}static rr(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=u.lr(i,s,t),r=u.lr(s,h,t);const o=u.lr(h,n,t);return e=u.lr(e,r,t),r=u.lr(r,o,t),u.lr(e,r,t)}static lr(t,i,s){return t+s*(i-t)}},l={LINEAR:t=>t,EASE:t=>u.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1),EASE_IN:t=>u.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1),EASE_OUT:t=>u.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1),EASE_IN_OUT:t=>u.solveYValueFromXValue(t,0,0,.42,0,.58,1,1,1)},f={"linear":l.LINEAR,"ease":l.EASE,"ease-in":l.EASE_IN,"ease-out":l.EASE_OUT,"ease-in-out":l.EASE_IN_OUT};function m(t){if(!t)return null;if(r(t)){if(-1!=(t=t).indexOf("cubic-bezier")){const i=t.match(/cubic-bezier\((.+)\)/);if(i){const t=i[1].split(",").map(parseFloat);if(4==t.length){for(let i=0;i<4;i++)if(isNaN(t[i]))return null;return c(t[0],t[1],t[2],t[3])}}return null}return f[t]}return t}function d(t){return 1==(null==(i=t)?void 0:i.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function _(t,i,s,h,n,e,r,o,a,c,u){return t}function p(t,i,s,h,n,r,o,a,c,u,l){return function(t,i,s="Assertion failed",h){var n,r;if(i)return i;t&&-1==s.indexOf(t)&&(s+=t);let o=3;const a=s.split("%s");let c=a.shift();const u=[c];for(;a.length;){const t=arguments[o++],i=a.shift();c+=d(t)+i,u.push(t,i.trim())}const l=new Error(c);throw l.messageArray=e(u,(t=>""!==t)),null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,l),l}("​​​",t,i,s,h,n,r,o,a,c,u,l)}function g(t){return(t.ownerDocument||t).defaultView}function A(t){_(/^[\w-]+$/.test(t))}function M(t,i,s,h){return{left:t,top:i,width:s,height:h,bottom:i+h,right:t+s,x:t,y:i}}function P(t){return M(Number(t.left),Number(t.top),Number(t.width),Number(t.height))}function v(t,i,s,h){const e=n(r=t)?r:[r];var r;for(const t of e){const n=i.getAttribute(t);null!==n?s.setAttribute(t,n):h&&s.removeAttribute(t)}}var E,b=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g,T=class{constructor(t){p(t.length>0,"Srcset must have at least one source"),this.Dw=t;let i=!1,s=!1;for(let h=0;h<t.length;h++){const n=t[h];i=i||!!n.width,s=s||!!n.dpr}p(!(i===s),"Srcset must have width or dpr sources, but not both"),t.sort(i?I:R),this.Fw=i}select(t,i){_(t),_(i);let s=0;return s=this.Fw?this.Lw(t*i):this.Uw(i),this.Dw[s].url}Lw(t){const i=this.Dw;let s=0,h=1/0,n=1/0;for(let r=0;r<i.length;r++){var e;const o=null!==(e=i[r].width)&&void 0!==e?e:0,a=Math.abs(o-t);if(!(a<=1.1*h||t/n>1.2))break;s=r,h=a,n=o}return s}Uw(t){const i=this.Dw;let s=0,h=1/0;for(let n=0;n<i.length;n++){const e=Math.abs(i[n].dpr-t);if(!(e<=h))break;s=n,h=e}return s}getUrls(){return this.Dw.map((t=>t.url))}stringify(t){const i=[],s=this.Dw;for(let h=0;h<s.length;h++){const n=s[h];let e=n.url;t&&(e=t(e)),this.Fw?e+=` ${n.width}w`:e+=` ${n.dpr}x`,i.push(e)}return i.join(", ")}};function I(t,i){return p(t.width!=i.width,"Duplicate width: %s",t.width),t.width-i.width}function R(t,i){return p(t.dpr!=i.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-i.dpr}function V(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:h}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=h,n}function w(t){let i=null,s="";for(const t of arguments)t instanceof Error&&!i?i=V(t):(s&&(s+=" "),s+=t);return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function y(t,...i){const s=w.apply(null,i);s.name=t||s.name,function(t){var i,s;null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t)}(s)}var x=["Webkit","webkit","Moz","moz","ms","O","o"];function S(t,i,s,h,n){const e=function(t,i,s){if(i.startsWith("--"))return i;E||(E=Object.create(null));let h=E[i];if(!h||s){if(h=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<x.length;s++){const h=x[s]+i;if(void 0!==t[h])return h}return""}(t,s);void 0!==t[n]&&(h=n)}s||(E[i]=h)}return h}(t.style,i,n);if(!e)return;const r=h?s+h:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return x.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(e),r)}function D(t,i){for(const s in i)S(t,s,i[s])}function k(t){return`${t}px`}function C(t,i){return"number"==typeof t?i(t):t}function X(t,i){return null==i?`translate(${C(t,k)})`:`translate(${C(t,k)}, ${C(i,k)})`}function O(t){return`scale(${t})`}function Y(t,i=" "){return(s,h)=>t.map((t=>t(s,h))).filter(r).join(i)}function z(t,i){return(s,h)=>{for(const e in i)S(t,("display"===(n=e)&&y("STYLE","`display` style detected. You must use toggle instead."),n),i[e](s,h));var n}}function $(t,i){return s=>t+(i-t)*s}function Z(t,i){return s=>X(t(s),null==i?void 0:i(s))}function L(t){return i=>O(t(i))}function N(t,i,s){return _(i<=s),Math.min(Math.max(t,i),s)}function B(t,i,s,h){return _(i<=s),N(t,i-h,s+h)}function U(t,i){return Math.sqrt(t*t+i*i)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var G=self.__AMP_LOG;function F(t,i){throw new Error("failed to call initLogConstructor")}function H(t){return F()}function j(){return G.dev||(G.dev=F())}function W(t,i,s,h,n,e,r,o,a,c,u){return t}function q(t,i){return Q(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function J(t){return t.nodeType?(i=g(t),q(i,"ampdoc")).getAmpDoc(t):t;var i}function K(t){const i=J(t);return i.isSingleDoc()?i.win:i}function Q(t,i){W(tt(t,i));const s=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return s.obj||(W(s.ctor),W(s.context),s.obj=new s.ctor(s.context),W(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function tt(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var it,st=t=>Q(t,"timer"),ht=t=>q(t,"vsync"),nt="Animation",et=function(){},rt=class{static animate(t,i,s,h){return new rt(t).setCurve(h).add(0,i,1).start(s)}constructor(t,i){this.cr=t,this.ar=i||ht(self),this.dr=null,this.pr=[]}setCurve(t){return t&&(this.dr=m(t)),this}add(t,i,s,h){return this.pr.push({delay:t,func:i,duration:s,curve:m(h)}),this}start(t){return new ot(this.ar,this.cr,this.pr,this.dr,t)}},ot=class{constructor(t,i,s,n,e){this.ar=t,this.cr=i,this.pr=[];for(let t=0;t<s.length;t++){const i=s[t];this.pr.push({delay:i.delay,func:i.func,duration:i.duration,curve:i.curve||n,started:!1,completed:!1})}this.mr=e,this.zn=Date.now(),this.be=!0,this.Ai={};const r=new h;this._r=r.promise,this.te=r.resolve,this.Ar=r.reject,this.gr=this.ar.createAnimTask(this.cr,{mutate:this.Pr.bind(this)}),this.ar.canAnimate(this.cr)?this.gr(this.Ai):this.vr(!1,0)}then(t,i){return t||i?this._r.then(t,i):this._r}thenAlways(t){const i=t||et;return this.then(i,i)}halt(t){this.vr(!1,t||0)}vr(t,i){if(this.be){if(this.be=!1,0!=i){this.pr.length>1&&this.pr.sort(((t,i)=>t.delay+t.duration-(i.delay+i.duration)));try{if(i>0)for(let t=0;t<this.pr.length;t++)this.pr[t].func(1,!0);else for(let t=this.pr.length-1;t>=0;t--)this.pr[t].func(0,!1)}catch(i){j().error(nt,"completion failed: "+i,i),t=!1}}t?this.te():this.Ar()}}Pr(t){if(!this.be)return;const i=Date.now(),s=Math.min((i-this.zn)/this.mr,1);for(let t=0;t<this.pr.length;t++){const i=this.pr[t];!i.started&&s>=i.delay&&(i.started=!0)}for(let t=0;t<this.pr.length;t++){const i=this.pr[t];i.started&&!i.completed&&this.Er(i,s)}1==s?this.vr(!0,0):this.ar.canAnimate(this.cr)?this.gr(this.Ai):this.vr(!1,0)}Er(t,i){let s,h;if(t.duration>0){if(s=Math.min((i-t.delay)/t.duration,1),h=s,t.curve&&1!=h)try{h=t.curve(s)}catch(t){return j().error(nt,"step curve failed: "+t,t),void this.vr(!1,0)}}else s=1,h=1;1==s&&(t.completed=!0);try{t.func(h,t.completed)}catch(t){return j().error(nt,"step mutate failed: "+t,t),void this.vr(!1,0)}}};function at(t){return!!(t.complete||"complete"==t.readyState||function(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}var ct=class{constructor(){this.St=null}add(t){return this.St||(this.St=[]),this.St.push(t),()=>{this.remove(t)}}remove(t){this.St&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.St,t)}removeAll(){this.St&&(this.St.length=0)}fire(t){if(this.St)for(const i of this.St.slice())i(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.St)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},ut="__AMP_Gestures",lt=class{static get(t,i=!1,s=!1){let h=t[ut];return h||(h=new lt(t,i,s),t[ut]=h),h}constructor(t,i=!1,s=!1){this._f=t,this.HV=[],this.t_=[],this.ci=[],this.XV=[],this.WV=null;const h=function(t){if(void 0!==it)return it;it=!1;try{const i={get passive(){return it=!0,!1}};t.addEventListener("test-options",null,i),t.removeEventListener("test-options",null,i)}catch(t){}return it}(t.ownerDocument.defaultView);this.UV=i||h,this.JV=s,this.QV=!1,this.Se=new class{constructor(t,i,s){this.Ie=st(t),this.Me=i,this.Re=s||0,this.ye=-1,this.we=0,this.be=!1,this.Ve=()=>{this.Se()}}isPending(){return-1!=this.ye}schedule(t){let i=t||this.Re;this.be&&i<10&&(i=10);const s=Date.now()+i;return(!this.isPending()||s-this.we<-10)&&(this.cancel(),this.we=s,this.ye=this.Ie.delay(this.Ve,i),!0)}Se(){this.ye=-1,this.we=0,this.be=!0,this.Me(),this.be=!1}cancel(){this.isPending()&&(this.Ie.cancel(this.ye),this.ye=-1)}}(g(t),this.Nd.bind(this)),this.tC=new ct,this.iC=Object.create(null),this.sC=this.Jp.bind(this),this.nC=this.Qp.bind(this),this.hC=this.Wp.bind(this),this.eC=this.h_.bind(this),this._f.addEventListener("touchstart",this.sC,!!h&&{passive:!0}),this._f.addEventListener("touchend",this.nC),this._f.addEventListener("touchmove",this.hC,!!h&&{passive:!0}),this._f.addEventListener("touchcancel",this.eC),this.oC=!1}cleanup(){this._f.removeEventListener("touchstart",this.sC),this._f.removeEventListener("touchend",this.nC),this._f.removeEventListener("touchmove",this.hC),this._f.removeEventListener("touchcancel",this.eC),delete this._f[ut],this.Se.cancel()}onGesture(t,i){const s=new t(this),h=s.getType();let n=this.iC[h];return n||(this.HV.push(s),n=new ct,this.iC[h]=n),n.add(i)}removeGesture(t){const i=new t(this).getType(),s=this.iC[i];if(s){s.removeAll();const t=function(t,s){for(let s=0;s<t.length;s++)if(t[s].getType()==i)return s;return-1}(this.HV);return!(t<0||(this.HV.splice(t,1),this.ci.splice(t,1),this.XV.splice(t,1),this.t_.splice(t,1),delete this.iC[i],0))}return!1}onPointerDown(t){return this.tC.add(t)}Jp(t){const i=Date.now();this.QV=!1,this.tC.fire(t);for(let s=0;s<this.HV.length;s++)this.ci[s]||(this.XV[s]&&this.XV[s]<i&&this.o_(s),this.HV[s].onTouchStart(t)&&this.u_(s));this.rC(t)}Wp(t){const i=Date.now();for(let s=0;s<this.HV.length;s++)this.t_[s]&&(this.XV[s]&&this.XV[s]<i?this.o_(s):this.HV[s].onTouchMove(t)||this.o_(s));this.rC(t)}Qp(t){const i=Date.now();for(let s=0;s<this.HV.length;s++){if(!this.t_[s])continue;if(this.XV[s]&&this.XV[s]<i){this.o_(s);continue}this.HV[s].onTouchEnd(t);const h=!this.XV[s],n=this.XV[s]<i;this.WV==this.HV[s]||!h&&!n||this.o_(s)}this.rC(t)}h_(t){for(let t=0;t<this.HV.length;t++)this.lC(t);this.rC(t)}Hp(t,i){if(this.WV)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.HV.length;h++)this.HV[h]==t&&(this.ci[h]=s+i,this.XV[h]=0);this.oC=!0}aC(t,i){if(this.WV)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.HV.length;h++)this.HV[h]==t&&(this.XV[h]=s+i)}cC(t){this.WV==t&&(this.WV=null,this.QV=!0)}uC(t,i,s){_(this.WV==t);const h=this.iC[t.getType()];h&&h.fire(new class{constructor(t,i,s,h){this.type=t,this.data=i,this.time=s,this.event=h}}(t.getType(),i,Date.now(),s))}rC(t){let i=!!this.WV||this.QV;if(this.QV=!1,!i){const t=Date.now();for(let s=0;s<this.HV.length;s++)if(this.ci[s]||this.XV[s]&&this.XV[s]>=t){i=!0;break}}i?(t.stopPropagation(),this.UV||t.preventDefault()):this.JV&&t.stopPropagation(),this.oC&&(this.oC=!1,this.Nd())}Nd(){const t=Date.now();let i=-1;for(let s=0;s<this.HV.length;s++)this.ci[s]?(-1==i||this.ci[s]>this.ci[i])&&(i=s):this.XV[s]&&this.XV[s]<t&&this.o_(s);if(-1==i)return;let s=0;for(let i=0;i<this.HV.length;i++)!this.ci[i]&&this.t_[i]&&(s=Math.max(s,this.XV[i]-t));s<2?this.fC(i):this.Se.schedule(s)}fC(t){const i=this.HV[t];for(let i=0;i<this.HV.length;i++)i!=t&&this.lC(i);this.ci[t]=0,this.XV[t]=0,this.WV=i,i.acceptStart()}u_(t){this.t_[t]=!0,this.XV[t]=0}o_(t){this.t_[t]=!1,this.XV[t]=0,this.ci[t]||this.HV[t].acceptCancel()}lC(t){this.ci[t]=0,this.o_(t)}},ft=class{constructor(t,i){this.SC=t,this.x_=i}getType(){return this.SC}signalReady(t){this.x_.Hp(this,t)}signalPending(t){this.x_.aC(this,t)}signalEnd(){this.x_.cC(this)}signalEmit(t,i){this.x_.uC(this,t,i)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}},mt=function(){},dt=.02,_t=Math.round(-16.67/Math.log(.95));function pt(t,i,s){i<1&&(i=1);const h=t/i,n=.5+Math.min(i/33.34,.5);return h*n+s*(1-n)}function gt(t,i,s,h,n,e,r){return new At(t,i,s,h,n,e,r).start()}var At=class{constructor(t,i,s,n,e,r,o){this.ar=o||ht(self),this.cr=t,this.$=r,this.jC=i,this.HC=s,this.tD=n,this.iD=e,this.GC=0,this.LC=0;const a=new h;this._r=a.promise,this.te=a.resolve,this.Ar=a.reject,this.sD=!1}start(){return this.sD=!0,Math.abs(this.tD)<=dt&&Math.abs(this.iD)<=dt?(this.hD(),this.nD(!0)):this.eD(),this}halt(){this.sD&&this.nD(!1)}then(t,i){return t||i?this._r.then(t,i):this._r}thenAlways(t){const i=t||mt;return this.then(i,i)}eD(){this.GC=this.tD,this.LC=this.iD;const t=this.rD.bind(this),i=this.nD.bind(this,!0);return this.ar.runAnimMutateSeries(this.cr,t,5e3).then(i,i)}rD(t,i){if(!this.sD)return!1;if(this.jC+=i*this.GC,this.HC+=i*this.LC,!this.hD())return!1;const s=Math.exp(-t/_t);return this.GC=this.tD*s,this.LC=this.iD*s,Math.abs(this.GC)>dt||Math.abs(this.LC)>dt}nD(t){this.sD&&(this.sD=!1,this.hD(),t?this.te():this.Ar())}hD(){return this.$(this.jC,this.HC)}},Mt=class extends ft{constructor(t){super("tap",t),this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.o=null}onTouchStart(t){const{touches:i}=t;return this.o=t.target,!(!i||1!=i.length||(this.zC=i[0].clientX,this.BC=i[0].clientY,0))}onTouchMove(t){const i=t.changedTouches||t.touches;if(i&&1==i.length){this.jC=i[0].clientX,this.HC=i[0].clientY;const t=Math.abs(this.jC-this.zC)>=8,s=Math.abs(this.HC-this.BC)>=8;if(t||s)return!1}return!0}onTouchEnd(t){this.signalReady(0)}acceptStart(){this.signalEmit({clientX:this.jC,clientY:this.HC,target:this.o},null),this.signalEnd()}},Pt=class extends ft{constructor(t){super("doubletap",t),this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.oD=0,this.aD=null}onTouchStart(t){if(this.oD>1)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.zC=i[0].clientX,this.BC=i[0].clientY,this.jC=i[0].clientX,this.HC=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){this.jC=i[0].clientX,this.HC=i[0].clientY;const t=Math.abs(this.jC-this.zC)>=8,s=Math.abs(this.HC-this.BC)>=8;return!t&&!s||(this.acceptCancel(),!1)}return!1}onTouchEnd(t){this.oD++,this.oD<2?this.signalPending(200):(this.aD=t,this.signalReady(0))}acceptStart(){this.oD=0,this.signalEmit({clientX:this.jC,clientY:this.HC},this.aD),this.signalEnd()}acceptCancel(){this.oD=0}},vt=class extends ft{constructor(t,i,s,h){super(t,i),this.OC=s,this.DC=h,this.WV=!1,this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.YC=0,this.$C=0,this.zn=0,this.XC=0,this.FC=0,this.GC=0,this.LC=0}onTouchStart(t){const{touches:i}=t;return!!(this.WV&&i&&i.length>1)||!(!i||1!=i.length)&&(this.zn=Date.now(),this.zC=i[0].clientX,this.BC=i[0].clientY,!0)}onTouchMove(t){const{touches:i}=t;if(i&&i.length>=1){const{clientX:s,clientY:h}=i[0];if(this.jC=s,this.HC=h,this.WV)this.WC(!1,!1,t);else{const t=Math.abs(s-this.zC),i=Math.abs(h-this.BC);if(this.OC&&this.DC)(t>=8||i>=8)&&this.signalReady(-10);else if(this.OC){if(t>=8&&t>i)this.signalReady(-10);else if(i>=8)return!1}else{if(!this.DC)return!1;if(i>=8&&i>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:i}=t;i&&0==i.length&&this.UC(t)}acceptStart(){this.WV=!0,this.YC=this.zC,this.$C=this.BC,this.FC=this.zn,this.zC=this.jC,this.BC=this.HC,this.WC(!0,!1,null)}acceptCancel(){this.WV=!1}WC(t,i,s){this.XC=Date.now();const h=this.XC-this.FC;if(!i&&h>4||i&&h>16){const t=pt(this.jC-this.YC,h,this.GC),s=pt(this.HC-this.$C,h,this.LC);(!i||h>32||0!=t||0!=s)&&(this.GC=Math.abs(t)>1e-4?t:0,this.LC=Math.abs(s)>1e-4?s:0),this.YC=this.jC,this.$C=this.HC,this.FC=this.XC}this.signalEmit({first:t,last:i,time:this.XC,deltaX:this.jC-this.zC,deltaY:this.HC-this.BC,startX:this.zC,startY:this.BC,lastX:this.jC,lastY:this.HC,velocityX:this.GC,velocityY:this.LC},s)}UC(t){this.WV&&(this.WV=!1,this.WC(!1,!0,t),this.signalEnd())}},Et=class extends vt{constructor(t){super("swipe-xy",t,!0,!0)}},bt=class extends ft{constructor(t){super("tapzoom",t),this.WV=!1,this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.oD=0,this.YC=0,this.$C=0,this.XC=0,this.FC=0,this.GC=0,this.LC=0}onTouchStart(t){if(this.WV)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.zC=i[0].clientX,this.BC=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){if(this.jC=i[0].clientX,this.HC=i[0].clientY,this.WV)this.WC(!1,!1,t);else{const t=Math.abs(this.jC-this.zC)>=8,i=Math.abs(this.HC-this.BC)>=8;if(t||i){if(0==this.oD)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1}onTouchEnd(t){this.WV?this.UC(t):(this.oD++,1!=this.oD?this.acceptCancel():this.signalPending(400))}acceptStart(){this.oD=0,this.WV=!0,this.WC(!0,!1,null)}acceptCancel(){this.oD=0,this.WV=!1}WC(t,i,s){this.XC=Date.now(),t?this.GC=this.LC=0:this.XC-this.FC>2&&(this.GC=pt(this.jC-this.YC,this.XC-this.FC,this.GC),this.LC=pt(this.HC-this.$C,this.XC-this.FC,this.LC)),this.YC=this.jC,this.$C=this.HC,this.FC=this.XC,this.signalEmit({first:t,last:i,centerClientX:this.zC,centerClientY:this.BC,deltaX:this.jC-this.zC,deltaY:this.HC-this.BC,velocityX:this.GC,velocityY:this.LC},s)}UC(t){this.WV&&(this.WV=!1,this.WC(!1,!0,t),this.signalEnd())}},Tt=new Set(["amp-img","amp-anim","img"]),It=["aria-label","aria-describedby","aria-labelledby"],Rt=c(.4,0,.2,1),Vt=c(.4,0,.2,1),wt=c(.4,0,.2,1.4),yt=class extends t.BaseElement{constructor(t){super(t),this.sS=-1,this.mC=!1,this.cD=!1,this.uD=null,this.lD=null,this.fD=null,this.hf=null,this.mD=null,this.dD=null,this.hS=this.oS.bind(this),this.registerDefaultAction((t=>this.HT(t)),"open")}buildCallback(){var t;(t=this.element,function(t,i){const s=K(J(t));return tt(s,i)?Q(s,i):null}(t,"action")).addToAllowlist("AMP-IMAGE-LIGHTBOX","open",["email"])}_D(){if(this.hf)return;this.hf=this.element.ownerDocument.createElement("div"),this.hf.classList.add("i-amphtml-image-lightbox-container"),this.element.appendChild(this.hf),this.mD=new class{constructor(t,i,s){this.pD=t,this.win=i,this.Vi=s,this.Fe=t.element.ownerDocument.createElement("div"),this.Fe.classList.add("i-amphtml-image-lightbox-viewer"),this.gD=t.element.ownerDocument.createElement("img"),this.gD.classList.add("i-amphtml-image-lightbox-viewer-image"),this.Fe.appendChild(this.gD),this.AD=null,this.MD=0,this.PD=0,this.vD=M(0,0,0,0),this.ED=M(0,0,0,0),this.bD=1,this.TD=1,this.ID=1,this.RD=1,this.VD=2,this.zC=0,this.BC=0,this.wD=0,this.yD=0,this.xD=0,this.SD=0,this.DD=0,this.kD=0,this.CD=null,this.Nj()}getElement(){return this.Fe}getImage(){return this.gD}getViewerBox(){return this.vD}getImageBox(){return this.ED}getImageBoxWithOffset(){return 0==this.wD&&0==this.yD?this.ED:(t=this.ED,i=this.wD,s=this.yD,0==i&&0==s||0==t.width&&0==t.height?t:M(t.left+i,t.top+s,t.width,t.height));var t,i,s}reset(){this.gD.setAttribute("src",""),It.forEach((t=>{this.gD.removeAttribute(t)})),this.gD.removeAttribute("aria-describedby"),this.AD=null,this.ED=M(0,0,0,0),this.MD=0,this.PD=0,this.ID=1,this.bD=1,this.TD=1,this.VD=2,this.zC=0,this.BC=0,this.wD=0,this.yD=0,this.xD=0,this.SD=0,this.DD=0,this.kD=0,this.CD&&this.CD.halt(),this.CD=null}XD(t,i){i?(this.MD=i.naturalWidth||t.offsetWidth,this.PD=i.naturalHeight||t.offsetHeight):(this.MD=t.offsetWidth,this.PD=t.offsetHeight)}init(t,i){this.XD(t,i),this.AD=function(t){const i=t.getAttribute("srcset");if(i)return function(t){const i=[];let s;for(;s=b.exec(t);){const t=s[1];let h,n;if(s[2]){const t=s[3].toLowerCase();if("w"==t)h=parseInt(s[2],10);else{if("x"!=t)continue;n=parseFloat(s[2])}}else n=1;i.push({url:t,width:h,dpr:n})}return new T(i)}(i);const s=t.getAttribute("src");return p(s,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new T([{url:s,width:void 0,dpr:1}])}(t),"img"===t.tagName.toLowerCase()?v(It,t,this.gD):t.getImpl().then((t=>v(It,t.element,this.gD))),i&&at(i)&&i.src&&this.gD.setAttribute("src",i.src)}measure(){this.vD=P(this.Fe.getBoundingClientRect());const t=this.MD/this.PD;let i=Math.min(this.vD.width/t,this.vD.height),s=Math.min(this.vD.height*t,this.vD.width);Math.abs(s-this.MD)<=16&&Math.abs(i-this.PD)<=16&&(s=this.MD,i=this.PD),this.ED=M(Math.round((this.vD.width-s)/2),Math.round((this.vD.height-i)/2),Math.round(s),Math.round(i)),D(this.gD,{top:k(this.ED.top),left:k(this.ED.left),width:k(this.ED.width),height:k(this.ED.height)});const h=this.vD.width/this.vD.height,n=Math.max(h/t,t/h);return this.VD=Math.max(2,n),this.TD=this.bD=1,this.zC=this.wD=0,this.BC=this.yD=0,this.OD(this.bD),this.YD(),this.zA()}zA(){if(!this.AD)return s();this.ID=Math.max(this.ID,this.bD);const t=this.ED.width*this.ID,i=this.AD.select(t,class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}}.getDevicePixelRatio());return i==this.gD.getAttribute("src")?s():st(this.win).promise(1).then((()=>(this.gD.setAttribute("src",i),this.Vi(this.gD))))}Nj(){const t=lt.get(this.gD);t.onGesture(Mt,(()=>{this.pD.toggleViewMode()})),t.onGesture(Et,(t=>{this.zD(t.data.deltaX,t.data.deltaY,!1),t.data.last&&this.$D(t.data.velocityX,t.data.velocityY)})),t.onPointerDown((()=>{this.CD&&this.CD.halt()})),t.onGesture(Pt,(t=>{let i;i=1==this.bD?this.VD:this.RD;const s=this.vD.width/2-t.data.clientX,h=this.vD.height/2-t.data.clientY;this.ZD(i,s,h,!0).then((()=>this.LD(0,0,0,0,0,0)))})),t.onGesture(bt,(t=>{this.ND(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY),t.data.last&&this.LD(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY,t.data.velocityY,t.data.velocityY)}))}BD(t,i){return B(t,this.RD,this.VD,i?.25:0)}UD(t,i){return B(t,this.xD,this.DD,i&&this.bD>1?.25*this.vD.width:0)}GD(t,i){return B(t,this.SD,this.kD,i?.25*this.vD.height:0)}OD(t){let i=0,s=0;const h=this.vD.height-this.ED.height*t;h>=0?s=i=0:(s=h/2,i=-s);let n=0,e=0;const r=this.vD.width-this.ED.width*t;r>=0?e=n=0:(e=r/2,n=-e),this.xD=e,this.SD=s,this.DD=n,this.kD=i}YD(){D(this.gD,{transform:X(this.wD,this.yD)+" "+O(this.bD)}),1!=this.bD&&this.pD.toggleViewMode(!0)}zD(t,i,s){const h=this.UD(this.zC+t,!0),n=this.GD(this.BC+i,!0);this.FD(this.bD,h,n,s)}$D(t,i){const s=this.yD-this.BC;1==this.bD&&Math.abs(s)>10?this.pD.close():(this.CD=gt(this.gD,this.wD,this.yD,t,i,((t,i)=>{const s=this.UD(t,!0),h=this.GD(i,!0);return!(Math.abs(s-this.wD)<1&&Math.abs(h-this.yD)<1||(this.FD(this.bD,s,h,!1),0))})),this.CD.thenAlways((()=>(this.CD=null,this.HD()))))}ND(t,i,s,h){const n=U(s,h),e=Math.abs(h)>Math.abs(s)?Math.sign(h):Math.sign(-s);if(0==e)return;const r=this.TD*(1+e*n/100),o=this.vD.width/2-t,a=this.vD.height/2-i;s=Math.min(o,o*(n/100)),h=Math.min(a,a*(n/100)),this.ZD(r,s,h,!1)}ZD(t,i,s,h){const n=this.BD(t,!0);if(n==this.bD)return;this.OD(n);const e=this.UD(this.zC+i*n,!1),r=this.GD(this.BC+s*n,!1);return this.FD(n,e,r,h)}LD(t,i,h,n,e,r){let o;o=0==e&&0==r?s():gt(this.gD,h,n,e,r,((s,h)=>(this.ND(t,i,s,h),!0))).thenAlways();const a=this.bD>this.TD;return o.then((()=>this.HD())).then((()=>{a&&this.zA()}))}FD(t,i,h,n){const e=t-this.bD,r=(o=this.wD,a=this.yD,U(i-o,h-a));var o,a;let c,u=0;if(n){const t=250;u=Math.min(t,Math.max(t*r*.01,t*Math.abs(e)))}if(u>16&&n){const s=$(this.bD,t),n=$(this.wD,i),e=$(this.yD,h);c=rt.animate(this.gD,(t=>{this.bD=s(t),this.wD=n(t),this.yD=e(t),this.YD()}),u,wt).thenAlways((()=>{this.bD=t,this.wD=i,this.yD=h,this.YD()}))}else this.bD=t,this.wD=i,this.yD=h,this.YD(),c=n?s():void 0;return c}HD(){const t=this.BD(this.bD,!1);t!=this.bD&&this.OD(t);const i=this.UD(this.wD/this.bD*t,!1),s=this.GD(this.yD/this.bD*t,!1);return this.FD(t,i,s,!0).then((()=>{this.TD=this.bD,this.zC=this.wD,this.BC=this.yD}))}}(this,this.win,this.loadPromise.bind(this)),this.hf.appendChild(this.mD.getElement()),this.dD=this.element.ownerDocument.createElement("div"),this.dD.setAttribute("id",this.element.getAttribute("id")+"-caption"),this.dD.classList.add("amp-image-lightbox-caption"),this.dD.classList.add("i-amphtml-image-lightbox-caption"),this.hf.appendChild(this.dD);const t=this.element.ownerDocument.createElement("button"),i=this.element.getAttribute("data-close-button-aria-label")||"Close the lightbox";t.textContent=i,t.classList.add("i-amphtml-screen-reader"),t.tabIndex=-1,t.addEventListener("click",(()=>{this.close()})),this.element.appendChild(t);const h=lt.get(this.element);this.element.addEventListener("click",(t=>{this.cD||this.mD.getImage().contains(t.target)||this.close()})),h.onGesture(Mt,(()=>{this.cD||this.close()})),h.onGesture(Et,(()=>{}))}HT(t){if(this.mC)return;this._D();const i=t.caller,s=i.tagName.toLowerCase();var h,n;h=i&&Tt.has(s),n=i.tagName,(G.user||(G.user=H()),void G.user.win?G.userForEmbed||(G.userForEmbed=H()):G.user).assert(h,"Unsupported element: %s",n,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),this.mC=!0,this.Ws(),this.Au(i),this.win.document.documentElement.addEventListener("keydown",this.hS),this.getViewport().enterLightboxMode(),this.H_(),this.fD=this.getViewport().onChanged((()=>{var t;this.mC&&((t=this.win,q(t,"platform")).getIosVersionString().startsWith("10.3")?st(this.win).delay((()=>{this.mD.measure()}),500):this.mD.measure())})),this.Kj().push(this.close.bind(this)).then((t=>{this.sS=t}))}oS(t){"Escape"==t.key&&(t.preventDefault(),this.close())}close(){this.mC&&(this.mC=!1,this.cD=!1,this.Z_(),this.fD&&(this.fD(),this.fD=null),this.getViewport().leaveLightboxMode(),-1!=this.sS&&this.Kj().pop(this.sS),this.win.document.documentElement.removeEventListener("keydown",this.hS),this.uD&&function(t){try{t.focus()}catch(t){}}(this.uD))}toggleViewMode(t){void 0!==t?this.hf.classList.toggle("i-amphtml-image-lightbox-view-mode",t):this.hf.classList.toggle("i-amphtml-image-lightbox-view-mode")}Au(t){var i;this.uD=t,this.lD=(i=t,A("img"),i.querySelector("> img".replace(/^|,/g,"$&:scope "))),this.mD.init(this.uD,this.lD);let s=null;const h=t.closest("figure");if(h&&(n=h,A(e="figcaption"),s=n.querySelector(e)),!s){const i=t.getAttribute("aria-describedby");s=this.element.ownerDocument.getElementById(i)}var n,e;s&&(function(t,i){const s=i.ownerDocument.createDocumentFragment();for(let i=t.firstChild;i;i=i.nextSibling)s.appendChild(i.cloneNode(!0));i.appendChild(s)}(s,this.dD),this.mD.getImage().setAttribute("aria-describedby",this.dD.getAttribute("id"))),this.dD.classList.toggle("i-amphtml-empty",!s)}Ws(){this.mD.reset(),function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.dD),this.uD=null,this.lD=null,this.toggleViewMode(!1)}H_(){var t,i;this.cD=!0,t=this.element,void 0===(i=!0)&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden",""),D(this.element,{opacity:0}),this.mD.measure();const s=new rt(this.element);s.add(0,z(this.element,{opacity:$(0,1)}),.6,Rt);let h=null;if(this.lD&&at(this.lD)&&this.lD.src){h=this.element.ownerDocument.createElement("div"),h.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(h);const t=P(this.lD.getBoundingClientRect()),i=this.mD.getImageBox(),n=this.lD.cloneNode(!0);n.className="",D(n,{position:"absolute",top:k(t.top),left:k(t.left),width:k(t.width),height:k(t.height),transformOrigin:"top left",willChange:"transform"}),h.appendChild(n),this.lD.classList.add("i-amphtml-ghost");const e=i.left-t.left,r=i.top-t.top,o=0!=t.width?i.width/t.width:1,a=N(Math.abs(r)/250*.8,.2,.8);s.add(0,z(n,{transform:Y([Z($(0,e),$(0,r)),L($(1,o))])}),a,Rt),D(this.hf,{opacity:0}),s.add(.8,z(this.hf,{opacity:$(0,1)}),.1,Rt),s.add(.9,z(h,{opacity:$(1,.01)}),.1,Vt)}return s.start(500).thenAlways((()=>{this.cD=!1,D(this.element,{opacity:""}),D(this.hf,{opacity:""}),h&&this.getAmpDoc().getBody().removeChild(h)}))}Z_(){const t=this.mD.getImage(),i=this.mD.getImageBoxWithOffset(),s=new rt(this.element);let h=500;s.add(0,z(this.element,{opacity:$(1,0)}),.9,Vt);let n=null;if(at(t)&&t.src&&this.lD){n=this.element.ownerDocument.createElement("div"),n.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(n);const e=P(this.lD.getBoundingClientRect()),r=t.cloneNode(!0);D(r,{position:"absolute",top:k(i.top),left:k(i.left),width:k(i.width),height:k(i.height),transform:"",transformOrigin:"top left",willChange:"transform"}),n.appendChild(r),s.add(0,z(this.hf,{opacity:$(1,0)}),.1,Vt);const o=e.left-i.left,a=e.top-i.top,c=0!=i.width?e.width/i.width:1,u=z(r,{transform:Y([Z($(0,o),$(0,a)),L($(1,c))])}),l=N(Math.abs(a)/250*.8,.2,.8);s.add(Math.min(.8-l,.2),((t,i)=>{u(t),i&&this.lD.classList.remove("i-amphtml-ghost")}),l,Vt),s.add(.8,z(n,{opacity:$(1,.01)}),.2,Vt),h=N(Math.abs(a)/250*h,300,h)}return s.start(h).thenAlways((()=>{this.lD&&this.lD.classList.remove("i-amphtml-ghost"),this.collapse(),D(this.element,{opacity:""}),D(this.hf,{opacity:""}),n&&this.getAmpDoc().getBody().removeChild(n),this.Ws()}))}Kj(){return function(t,i){return Q(K(J(t)),"history")}(this.getAmpDoc())}};t.registerElement("amp-image-lightbox",yt,"amp-image-lightbox{position:fixed!important;top:0!important;left:0!important;bottom:0!important;right:0!important;margin:0!important;padding:0!important;overflow:hidden!important;transform:translateZ(0)!important;-ms-touch-action:none!important;touch-action:none!important;z-index:1000;background:rgba(0,0,0,0.95);color:#f2f2f2}.i-amphtml-image-lightbox-container{position:absolute;z-index:0;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-trans{pointer-events:none!important;position:fixed;z-index:1001;top:0;left:0;bottom:0;right:0}.i-amphtml-image-lightbox-caption{position:absolute!important;z-index:2;bottom:0!important;left:0!important;right:0!important}.i-amphtml-image-lightbox-caption.i-amphtml-empty,.i-amphtml-image-lightbox-view-mode .i-amphtml-image-lightbox-caption{visibility:hidden}.amp-image-lightbox-caption{background:rgba(0,0,0,0.5);max-height:25%;padding:8px}.i-amphtml-image-lightbox-viewer{position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-viewer-image{position:absolute;z-index:1;display:block;transform-origin:50% 50%}\n/*# sourceURL=/extensions/amp-image-lightbox/0.1/amp-image-lightbox.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-lightbox-0.1.mjs.map