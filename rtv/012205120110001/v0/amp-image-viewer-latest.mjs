;
(self.AMP=self.AMP||[]).push({m:1,v:"2205120110001",n:"amp-image-viewer",ev:"0.1",l:!0,f:function(t,s){(()=>{var s;function i(){return s||(s=Promise.resolve(void 0))}var h=class{constructor(){this.promise=new Promise(((t,s)=>{this.resolve=t,this.reject=s}))}},{isArray:e}=Array;function n(t,s){const i=[];let h=0;for(let e=0;e<t.length;e++){const n=t[e];s(n,e,t)?i.push(n):(h<e&&(t[h]=n),h++)}return h<t.length&&(t.length=h),i}function r(t){return"string"==typeof t}var{hasOwnProperty:o,toString:c}=Object.prototype;function u(t){return 1==(null==t?void 0:t.nodeType)}function a(t,s,i,h){return e=>f.solveYValueFromXValue(e,0,0,t,s,i,h,1,1)}var l,f=class{static solveYValueFromXValue(t,s,i,h,e,n,r,o,c){return f.rr(f.hr(t,s,h,n,o),i,e,r,c)}static hr(t,s,i,h,e){const n=1e-6;let r=(t-s)/(e-s);if(r<=0)return 0;if(r>=1)return 1;let o=0,c=1,u=0;for(let a=0;a<8;a++){u=f.ur(r,s,i,h,e);const a=(f.ur(r+n,s,i,h,e)-u)/n;if(Math.abs(u-t)<n)return r;if(Math.abs(a)<n)break;u<t?o=r:c=r,r-=(u-t)/a}for(let a=0;Math.abs(u-t)>n&&a<8;a++)u<t?(o=r,r=(r+c)/2):(c=r,r=(r+o)/2),u=f.ur(r,s,i,h,e);return r}static ur(t,s,i,h,e){if(0==t)return s;if(1==t)return e;let n=f.lr(s,i,t),r=f.lr(i,h,t);const o=f.lr(h,e,t);return n=f.lr(n,r,t),r=f.lr(r,o,t),f.lr(n,r,t)}static rr(t,s,i,h,e){if(0==t)return s;if(1==t)return e;let n=f.lr(s,i,t),r=f.lr(i,h,t);const o=f.lr(h,e,t);return n=f.lr(n,r,t),r=f.lr(r,o,t),f.lr(n,r,t)}static lr(t,s,i){return t+i*(s-t)}},_={LINEAR:t=>t,EASE:t=>f.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1),EASE_IN:t=>f.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1),EASE_OUT:t=>f.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1),EASE_IN_OUT:t=>f.solveYValueFromXValue(t,0,0,.42,0,.58,1,1,1)},P={"linear":_.LINEAR,"ease":_.EASE,"ease-in":_.EASE_IN,"ease-out":_.EASE_OUT,"ease-in-out":_.EASE_IN_OUT};function M(t){if(!t)return null;if(r(t)){if(-1!=(t=t).indexOf("cubic-bezier")){const s=t.match(/cubic-bezier\((.+)\)/);if(s){const t=s[1].split(",").map(parseFloat);if(4==t.length){for(let s=0;s<4;s++)if(isNaN(t[s]))return null;return a(t[0],t[1],t[2],t[3])}}return null}return P[t]}return t}function A(t){return u(t)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t}function d(t,s,i,h,e,n,r,o,c,u,a){return t}function m(t,s,i,h,e,r,o,c,u,a,l){return function(t,s,i="Assertion failed",h){var e,r;if(s)return s;t&&-1==i.indexOf(t)&&(i+=t);let o=3;const c=i.split("%s");let u=c.shift();const a=[u];for(;c.length;){const t=arguments[o++],s=c.shift();u+=A(t)+s,a.push(t,s.trim())}const l=new Error(u);throw l.messageArray=n(a,(t=>""!==t)),null===(e=(r=self).__AMP_REPORT_ERROR)||void 0===e||e.call(r,l),l}("​​​",t,s,i,h,e,r,o,c,u,a,l)}function p(t,s,i,h){return{left:t,top:s,width:i,height:h,bottom:s+h,right:t+i,x:t,y:s}}function v(t){const s=Object.getOwnPropertyDescriptor(t,"message");if(null!=s&&s.writable)return t;const{message:i,stack:h}=t,e=new Error(i);for(const s in t)e[s]=t[s];return e.stack=h,e}function E(t){let s=null,i="";for(const t of arguments)t instanceof Error&&!s?s=v(t):(i&&(i+=" "),i+=t);return s?i&&(s.message=i+": "+s.message):s=new Error(i),s}function T(t){var s,i;null===(s=(i=self).__AMP_REPORT_ERROR)||void 0===s||s.call(i,t)}function g(t,...s){try{return t.apply(null,s)}catch(t){!function(t){const s=E.apply(null,arguments);setTimeout((()=>{throw T(s),s}))}(t)}}var I=["Webkit","webkit","Moz","moz","ms","O","o"],R={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function V(t,s,i,h,e){const n=function(t,s,i){if(s.startsWith("--"))return s;l||(l=Object.create(null));let h=l[s];if(!h||i){if(h=s,void 0===t[s]){const i=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(s),e=function(t,s){for(let i=0;i<I.length;i++){const h=I[i]+s;if(void 0!==t[h])return h}return""}(t,i);void 0!==t[e]&&(h=e)}i||(l[s]=h)}return h}(t.style,s,e);if(!n)return;const r=h?i+h:i;t.style.setProperty(function(t){const s=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return I.some((t=>s.startsWith(t+"-")))?`-${s}`:s}(n),r)}function w(t,s){for(const i in s)V(t,i,s[i])}function b(t){return`${t}px`}function y(t,s){return"number"==typeof t?s(t):t}function S(t){return(t.ownerDocument||t).defaultView}var D=/vertical/,k=new WeakMap,C=new WeakMap,x=new WeakMap;function X(t){let s=k.get(t);return s||(s=new t.ResizeObserver(Y),k.set(t,s)),s}function Y(t){const s=new Set;for(let i=t.length-1;i>=0;i--){const h=t[i],{target:e}=h;if(s.has(e))continue;s.add(e);const n=C.get(e);if(n){x.set(e,h);for(let t=0;t<n.length;t++){const{callback:s,type:i}=n[t];O(i,s,h)}}}}function O(t,s,i){if(0==t){const{contentRect:t}=i,{height:h,width:e}=t;g(s,{width:e,height:h})}else if(1==t){const{borderBoxSize:t}=i;let h;if(t)h=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=i,s=S(t),e=D.test(function(t,s){return t.getComputedStyle(s)||R}(s,t).writingMode),{offsetHeight:n,offsetWidth:r}=t;let o,c;e?(c=r,o=n):(o=r,c=n),h={inlineSize:o,blockSize:c}}g(s,h)}}function z(t,s,i,h){const n=e(r=t)?r:[r];var r;for(const t of n){const e=s.getAttribute(t);null!==e?i.setAttribute(t,e):h&&i.removeAttribute(t)}}function Z(t,s){return t.closest(s)}var N=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g,$=class{constructor(t){m(t.length>0,"Srcset must have at least one source"),this.Dw=t;let s=!1,i=!1;for(let h=0;h<t.length;h++){const e=t[h];s=s||!!e.width,i=i||!!e.dpr}m(!(s===i),"Srcset must have width or dpr sources, but not both"),t.sort(s?G:j),this.Fw=s}select(t,s){d(t),d(s);let i=0;return i=this.Fw?this.Lw(t*s):this.Uw(s),this.Dw[i].url}Lw(t){const s=this.Dw;let i=0,h=1/0,e=1/0;for(let r=0;r<s.length;r++){var n;const o=null!==(n=s[r].width)&&void 0!==n?n:0,c=Math.abs(o-t);if(!(c<=1.1*h||t/e>1.2))break;i=r,h=c,e=o}return i}Uw(t){const s=this.Dw;let i=0,h=1/0;for(let e=0;e<s.length;e++){const n=Math.abs(s[e].dpr-t);if(!(n<=h))break;i=e,h=n}return i}getUrls(){return this.Dw.map((t=>t.url))}stringify(t){const s=[],i=this.Dw;for(let h=0;h<i.length;h++){const e=i[h];let n=e.url;t&&(n=t(n)),this.Fw?n+=` ${e.width}w`:n+=` ${e.dpr}x`,s.push(n)}return s.join(", ")}};function G(t,s){return m(t.width!=s.width,"Duplicate width: %s",t.width),t.width-s.width}function j(t,s){return m(t.dpr!=s.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-s.dpr}function U(t,s){return i=>t+(s-t)*i}function B(t,s,i,h){return d(s<=i),function(t,s,i){return d(s<=i),Math.min(Math.max(t,s),i)}(t,s-h,i+h)}function L(t,s){return Math.sqrt(t*t+s*s)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var W=self.__AMP_LOG;function F(t,s){throw new Error("failed to call initLogConstructor")}function H(t){return W.user||(W.user=q()),function(t,s){return s&&s.ownerDocument.defaultView!=t}(W.user.win,t)?W.userForEmbed||(W.userForEmbed=q()):W.user}function q(t){return F()}function J(){return W.dev||(W.dev=F())}function K(t,s,i,h,e,n,r,o,c,u,a){return t}function Q(t,s,i,h,e,n,r,o,c,u,a){return H().assert(t,s,i,h,e,n,r,o,c,u,a)}function tt(t,s){return it(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),s)}function st(t){return t.nodeType?(s=S(t),tt(s,"ampdoc")).getAmpDoc(t):t;var s}function it(t,s){K(function(t,s){const i=t.__AMP_SERVICES&&t.__AMP_SERVICES[s];return!(!i||!i.ctor)}(t,s));const i=function(t){let s=t.__AMP_SERVICES;return s||(s=t.__AMP_SERVICES={}),s}(t)[s];return i.obj||(K(i.ctor),K(i.context),i.obj=new i.ctor(i.context),K(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}var ht,et,nt=t=>function(t,s){return it(function(t){const s=st(t);return s.isSingleDoc()?s.win:s}(st(t)),s)}(t,"owners"),rt=t=>tt(t,"vsync"),ot="Animation",ct=function(){},ut=class{static animate(t,s,i,h){return new ut(t).setCurve(h).add(0,s,1).start(i)}constructor(t,s){this.cr=t,this.ar=s||rt(self),this.dr=null,this.pr=[]}setCurve(t){return t&&(this.dr=M(t)),this}add(t,s,i,h){return this.pr.push({delay:t,func:s,duration:i,curve:M(h)}),this}start(t){return new at(this.ar,this.cr,this.pr,this.dr,t)}},at=class{constructor(t,s,i,e,n){this.ar=t,this.cr=s,this.pr=[];for(let t=0;t<i.length;t++){const s=i[t];this.pr.push({delay:s.delay,func:s.func,duration:s.duration,curve:s.curve||e,started:!1,completed:!1})}this.mr=n,this.zn=Date.now(),this.be=!0,this.Ai={};const r=new h;this._r=r.promise,this.te=r.resolve,this.Ar=r.reject,this.gr=this.ar.createAnimTask(this.cr,{mutate:this.Pr.bind(this)}),this.ar.canAnimate(this.cr)?this.gr(this.Ai):this.vr(!1,0)}then(t,s){return t||s?this._r.then(t,s):this._r}thenAlways(t){const s=t||ct;return this.then(s,s)}halt(t){this.vr(!1,t||0)}vr(t,s){if(this.be){if(this.be=!1,0!=s){this.pr.length>1&&this.pr.sort(((t,s)=>t.delay+t.duration-(s.delay+s.duration)));try{if(s>0)for(let t=0;t<this.pr.length;t++)this.pr[t].func(1,!0);else for(let t=this.pr.length-1;t>=0;t--)this.pr[t].func(0,!1)}catch(s){J().error(ot,"completion failed: "+s,s),t=!1}}t?this.te():this.Ar()}}Pr(t){if(!this.be)return;const s=Date.now(),i=Math.min((s-this.zn)/this.mr,1);for(let t=0;t<this.pr.length;t++){const s=this.pr[t];!s.started&&i>=s.delay&&(s.started=!0)}for(let t=0;t<this.pr.length;t++){const s=this.pr[t];s.started&&!s.completed&&this.Er(s,i)}1==i?this.vr(!0,0):this.ar.canAnimate(this.cr)?this.gr(this.Ai):this.vr(!1,0)}Er(t,s){let i,h;if(t.duration>0){if(i=Math.min((s-t.delay)/t.duration,1),h=i,t.curve&&1!=h)try{h=t.curve(i)}catch(t){return J().error(ot,"step curve failed: "+t,t),void this.vr(!1,0)}}else i=1,h=1;1==i&&(t.completed=!0);try{t.func(h,t.completed)}catch(t){return J().error(ot,"step mutate failed: "+t,t),void this.vr(!1,0)}}};function lt(t,s,i,h){let e=i;const n=function(t,s,i,h){let e=t,n=i,r=t=>{try{return n(t)}catch(t){var s,i;throw null===(s=(i=self).__AMP_REPORT_ERROR)||void 0===s||s.call(i,t),t}};const o=function(){if(void 0!==ht)return ht;ht=!1;try{const t={get capture(){return ht=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return ht}(),c=!(null==h||!h.capture);return e.addEventListener(s,r,o?h:c),()=>{null==e||e.removeEventListener(s,r,o?h:c),n=null,e=null,r=null}}(t,s,(t=>{try{e(t)}finally{e=null,n()}}),h);return n}function ft(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}var _t=class{constructor(){this.St=null}add(t){return this.St||(this.St=[]),this.St.push(t),()=>{this.remove(t)}}remove(t){this.St&&function(t,s){const i=t.indexOf(s);-1!=i&&t.splice(i,1)}(this.St,t)}removeAll(){this.St&&(this.St.length=0)}fire(t){if(this.St)for(const s of this.St.slice())s(t)}getHandlerCount(){var t,s;return null!==(t=null===(s=this.St)||void 0===s?void 0:s.length)&&void 0!==t?t:0}},Pt="__AMP_Gestures",Mt=class{static get(t,s=!1,i=!1){let h=t[Pt];return h||(h=new Mt(t,s,i),t[Pt]=h),h}constructor(t,s=!1,i=!1){this._f=t,this.HV=[],this.t_=[],this.ci=[],this.XV=[],this.WV=null;const h=function(t){if(void 0!==et)return et;et=!1;try{const s={get passive(){return et=!0,!1}};t.addEventListener("test-options",null,s),t.removeEventListener("test-options",null,s)}catch(t){}return et}(t.ownerDocument.defaultView);this.UV=s||h,this.JV=i,this.QV=!1,this.Se=new class{constructor(t,s,i){this.Ie=it(t,"timer"),this.Me=s,this.Re=i||0,this.ye=-1,this.we=0,this.be=!1,this.Ve=()=>{this.Se()}}isPending(){return-1!=this.ye}schedule(t){let s=t||this.Re;this.be&&s<10&&(s=10);const i=Date.now()+s;return(!this.isPending()||i-this.we<-10)&&(this.cancel(),this.we=i,this.ye=this.Ie.delay(this.Ve,s),!0)}Se(){this.ye=-1,this.we=0,this.be=!0,this.Me(),this.be=!1}cancel(){this.isPending()&&(this.Ie.cancel(this.ye),this.ye=-1)}}(S(t),this.Nd.bind(this)),this.tC=new _t,this.iC=Object.create(null),this.sC=this.Jp.bind(this),this.nC=this.Qp.bind(this),this.hC=this.Wp.bind(this),this.eC=this.h_.bind(this),this._f.addEventListener("touchstart",this.sC,!!h&&{passive:!0}),this._f.addEventListener("touchend",this.nC),this._f.addEventListener("touchmove",this.hC,!!h&&{passive:!0}),this._f.addEventListener("touchcancel",this.eC),this.oC=!1}cleanup(){this._f.removeEventListener("touchstart",this.sC),this._f.removeEventListener("touchend",this.nC),this._f.removeEventListener("touchmove",this.hC),this._f.removeEventListener("touchcancel",this.eC),delete this._f[Pt],this.Se.cancel()}onGesture(t,s){const i=new t(this),h=i.getType();let e=this.iC[h];return e||(this.HV.push(i),e=new _t,this.iC[h]=e),e.add(s)}removeGesture(t){const s=new t(this).getType(),i=this.iC[s];if(i){i.removeAll();const t=function(t,i){for(let i=0;i<t.length;i++)if(t[i].getType()==s)return i;return-1}(this.HV);return!(t<0||(this.HV.splice(t,1),this.ci.splice(t,1),this.XV.splice(t,1),this.t_.splice(t,1),delete this.iC[s],0))}return!1}onPointerDown(t){return this.tC.add(t)}Jp(t){const s=Date.now();this.QV=!1,this.tC.fire(t);for(let i=0;i<this.HV.length;i++)this.ci[i]||(this.XV[i]&&this.XV[i]<s&&this.o_(i),this.HV[i].onTouchStart(t)&&this.u_(i));this.rC(t)}Wp(t){const s=Date.now();for(let i=0;i<this.HV.length;i++)this.t_[i]&&(this.XV[i]&&this.XV[i]<s?this.o_(i):this.HV[i].onTouchMove(t)||this.o_(i));this.rC(t)}Qp(t){const s=Date.now();for(let i=0;i<this.HV.length;i++){if(!this.t_[i])continue;if(this.XV[i]&&this.XV[i]<s){this.o_(i);continue}this.HV[i].onTouchEnd(t);const h=!this.XV[i],e=this.XV[i]<s;this.WV==this.HV[i]||!h&&!e||this.o_(i)}this.rC(t)}h_(t){for(let t=0;t<this.HV.length;t++)this.lC(t);this.rC(t)}Hp(t,s){if(this.WV)return void t.acceptCancel();const i=Date.now();for(let h=0;h<this.HV.length;h++)this.HV[h]==t&&(this.ci[h]=i+s,this.XV[h]=0);this.oC=!0}aC(t,s){if(this.WV)return void t.acceptCancel();const i=Date.now();for(let h=0;h<this.HV.length;h++)this.HV[h]==t&&(this.XV[h]=i+s)}cC(t){this.WV==t&&(this.WV=null,this.QV=!0)}uC(t,s,i){d(this.WV==t);const h=this.iC[t.getType()];h&&h.fire(new class{constructor(t,s,i,h){this.type=t,this.data=s,this.time=i,this.event=h}}(t.getType(),s,Date.now(),i))}rC(t){let s=!!this.WV||this.QV;if(this.QV=!1,!s){const t=Date.now();for(let i=0;i<this.HV.length;i++)if(this.ci[i]||this.XV[i]&&this.XV[i]>=t){s=!0;break}}s?(t.stopPropagation(),this.UV||t.preventDefault()):this.JV&&t.stopPropagation(),this.oC&&(this.oC=!1,this.Nd())}Nd(){const t=Date.now();let s=-1;for(let i=0;i<this.HV.length;i++)this.ci[i]?(-1==s||this.ci[i]>this.ci[s])&&(s=i):this.XV[i]&&this.XV[i]<t&&this.o_(i);if(-1==s)return;let i=0;for(let s=0;s<this.HV.length;s++)!this.ci[s]&&this.t_[s]&&(i=Math.max(i,this.XV[s]-t));i<2?this.fC(s):this.Se.schedule(i)}fC(t){const s=this.HV[t];for(let s=0;s<this.HV.length;s++)s!=t&&this.lC(s);this.ci[t]=0,this.XV[t]=0,this.WV=s,s.acceptStart()}u_(t){this.t_[t]=!0,this.XV[t]=0}o_(t){this.t_[t]=!1,this.XV[t]=0,this.ci[t]||this.HV[t].acceptCancel()}lC(t){this.ci[t]=0,this.o_(t)}},At=class{constructor(t,s){this.SC=t,this.x_=s}getType(){return this.SC}signalReady(t){this.x_.Hp(this,t)}signalPending(t){this.x_.aC(this,t)}signalEnd(){this.x_.cC(this)}signalEmit(t,s){this.x_.uC(this,t,s)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}},dt=function(){},mt=.02,pt=Math.round(-16.67/Math.log(.95));function vt(t,s,i){s<1&&(s=1);const h=t/s,e=.5+Math.min(s/33.34,.5);return h*e+i*(1-e)}function Et(t,s,i,h,e,n,r){return new Tt(t,s,i,h,e,n,r).start()}var Tt=class{constructor(t,s,i,e,n,r,o){this.ar=o||rt(self),this.cr=t,this.$=r,this.jC=s,this.HC=i,this.tD=e,this.iD=n,this.GC=0,this.LC=0;const c=new h;this._r=c.promise,this.te=c.resolve,this.Ar=c.reject,this.sD=!1}start(){return this.sD=!0,Math.abs(this.tD)<=mt&&Math.abs(this.iD)<=mt?(this.hD(),this.nD(!0)):this.eD(),this}halt(){this.sD&&this.nD(!1)}then(t,s){return t||s?this._r.then(t,s):this._r}thenAlways(t){const s=t||dt;return this.then(s,s)}eD(){this.GC=this.tD,this.LC=this.iD;const t=this.rD.bind(this),s=this.nD.bind(this,!0);return this.ar.runAnimMutateSeries(this.cr,t,5e3).then(s,s)}rD(t,s){if(!this.sD)return!1;if(this.jC+=s*this.GC,this.HC+=s*this.LC,!this.hD())return!1;const i=Math.exp(-t/pt);return this.GC=this.tD*i,this.LC=this.iD*i,Math.abs(this.GC)>mt||Math.abs(this.LC)>mt}nD(t){this.sD&&(this.sD=!1,this.hD(),t?this.te():this.Ar())}hD(){return this.$(this.jC,this.HC)}},gt=class extends At{constructor(t){super("tap",t),this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.o=null}onTouchStart(t){const{touches:s}=t;return this.o=t.target,!(!s||1!=s.length||(this.zC=s[0].clientX,this.BC=s[0].clientY,0))}onTouchMove(t){const s=t.changedTouches||t.touches;if(s&&1==s.length){this.jC=s[0].clientX,this.HC=s[0].clientY;const t=Math.abs(this.jC-this.zC)>=8,i=Math.abs(this.HC-this.BC)>=8;if(t||i)return!1}return!0}onTouchEnd(t){this.signalReady(0)}acceptStart(){this.signalEmit({clientX:this.jC,clientY:this.HC,target:this.o},null),this.signalEnd()}},It=class extends At{constructor(t){super("doubletap",t),this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.oD=0,this.aD=null}onTouchStart(t){if(this.oD>1)return!1;const{touches:s}=t;return!(!s||1!=s.length||(this.zC=s[0].clientX,this.BC=s[0].clientY,this.jC=s[0].clientX,this.HC=s[0].clientY,0))}onTouchMove(t){const{touches:s}=t;if(s&&1==s.length){this.jC=s[0].clientX,this.HC=s[0].clientY;const t=Math.abs(this.jC-this.zC)>=8,i=Math.abs(this.HC-this.BC)>=8;return!t&&!i||(this.acceptCancel(),!1)}return!1}onTouchEnd(t){this.oD++,this.oD<2?this.signalPending(200):(this.aD=t,this.signalReady(0))}acceptStart(){this.oD=0,this.signalEmit({clientX:this.jC,clientY:this.HC},this.aD),this.signalEnd()}acceptCancel(){this.oD=0}},Rt=class extends At{constructor(t,s,i,h){super(t,s),this.OC=i,this.DC=h,this.WV=!1,this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.YC=0,this.$C=0,this.zn=0,this.XC=0,this.FC=0,this.GC=0,this.LC=0}onTouchStart(t){const{touches:s}=t;return!!(this.WV&&s&&s.length>1)||!(!s||1!=s.length)&&(this.zn=Date.now(),this.zC=s[0].clientX,this.BC=s[0].clientY,!0)}onTouchMove(t){const{touches:s}=t;if(s&&s.length>=1){const{clientX:i,clientY:h}=s[0];if(this.jC=i,this.HC=h,this.WV)this.WC(!1,!1,t);else{const t=Math.abs(i-this.zC),s=Math.abs(h-this.BC);if(this.OC&&this.DC)(t>=8||s>=8)&&this.signalReady(-10);else if(this.OC){if(t>=8&&t>s)this.signalReady(-10);else if(s>=8)return!1}else{if(!this.DC)return!1;if(s>=8&&s>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:s}=t;s&&0==s.length&&this.UC(t)}acceptStart(){this.WV=!0,this.YC=this.zC,this.$C=this.BC,this.FC=this.zn,this.zC=this.jC,this.BC=this.HC,this.WC(!0,!1,null)}acceptCancel(){this.WV=!1}WC(t,s,i){this.XC=Date.now();const h=this.XC-this.FC;if(!s&&h>4||s&&h>16){const t=vt(this.jC-this.YC,h,this.GC),i=vt(this.HC-this.$C,h,this.LC);(!s||h>32||0!=t||0!=i)&&(this.GC=Math.abs(t)>1e-4?t:0,this.LC=Math.abs(i)>1e-4?i:0),this.YC=this.jC,this.$C=this.HC,this.FC=this.XC}this.signalEmit({first:t,last:s,time:this.XC,deltaX:this.jC-this.zC,deltaY:this.HC-this.BC,startX:this.zC,startY:this.BC,lastX:this.jC,lastY:this.HC,velocityX:this.GC,velocityY:this.LC},i)}UC(t){this.WV&&(this.WV=!1,this.WC(!1,!0,t),this.signalEnd())}},Vt=class extends Rt{constructor(t){super("swipe-xy",t,!0,!0)}},wt=class extends At{constructor(t){super("tapzoom",t),this.WV=!1,this.zC=0,this.BC=0,this.jC=0,this.HC=0,this.oD=0,this.YC=0,this.$C=0,this.XC=0,this.FC=0,this.GC=0,this.LC=0}onTouchStart(t){if(this.WV)return!1;const{touches:s}=t;return!(!s||1!=s.length||(this.zC=s[0].clientX,this.BC=s[0].clientY,0))}onTouchMove(t){const{touches:s}=t;if(s&&1==s.length){if(this.jC=s[0].clientX,this.HC=s[0].clientY,this.WV)this.WC(!1,!1,t);else{const t=Math.abs(this.jC-this.zC)>=8,s=Math.abs(this.HC-this.BC)>=8;if(t||s){if(0==this.oD)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1}onTouchEnd(t){this.WV?this.UC(t):(this.oD++,1!=this.oD?this.acceptCancel():this.signalPending(400))}acceptStart(){this.oD=0,this.WV=!0,this.WC(!0,!1,null)}acceptCancel(){this.oD=0,this.WV=!1}WC(t,s,i){this.XC=Date.now(),t?this.GC=this.LC=0:this.XC-this.FC>2&&(this.GC=vt(this.jC-this.YC,this.XC-this.FC,this.GC),this.LC=vt(this.HC-this.$C,this.XC-this.FC,this.LC)),this.YC=this.jC,this.$C=this.HC,this.FC=this.XC,this.signalEmit({first:t,last:s,centerClientX:this.zC,centerClientY:this.BC,deltaX:this.jC-this.zC,deltaY:this.HC-this.BC,velocityX:this.GC,velocityY:this.LC},i)}UC(t){this.WV&&(this.WV=!1,this.WC(!1,!0,t),this.signalEnd())}},bt=class extends At{constructor(t){super("pinch",t),this.WV=!1,this.jD=0,this.WD=0,this.qD=0,this.JD=0,this.KD=0,this.QD=0,this.tX=0,this.sX=0,this.iX=0,this.hX=0,this.nX=0,this.eX=0,this.zn=0,this.XC=0,this.FC=0,this.GC=0,this.LC=0}onTouchStart(t){const{touches:s}=t;return!!s&&(1==s.length||!!(this.WV&&s.length>2)||2==s.length&&(this.zn=Date.now(),this.jD=s[0].clientX,this.WD=s[0].clientY,this.qD=s[1].clientX,this.JD=s[1].clientY,!0))}onTouchMove(t){const{touches:s}=t;return!(!s||0==s.length||1!=s.length&&(this.KD=s[0].clientX,this.QD=s[0].clientY,this.tX=s[1].clientX,this.sX=s[1].clientY,this.WV?(this.WC(!1,!1,t),0):this.oX()||(this.rX()&&this.signalReady(0),0)))}rX(){const t=this.KD-this.jD,s=this.QD-this.WD,i=this.tX-this.qD,h=this.sX-this.JD,e=t*i<=0&&s*h<=0,n=Math.abs(t-i)>=4,r=Math.abs(s-h)>=4;return e&&(n||r)}oX(){const t=this.KD-this.jD,s=this.QD-this.WD,i=this.tX-this.qD,h=this.sX-this.JD,e=t*i>0||s*h>0,n=Math.abs(t+i)>=10,r=Math.abs(s+h)>=10;return e&&(n||r)}onTouchEnd(t){const{touches:s}=t;s&&s.length<2&&this.UC(t)}acceptStart(){this.WV=!0,this.FC=this.zn,this.iX=0,this.hX=0,this.nX=.5*(this.jD+this.qD),this.eX=.5*(this.WD+this.JD),this.WC(!0,!1,null)}acceptCancel(){this.WV=!1}WC(t,s,i){this.XC=Date.now();const h=this.XC-this.FC,e=this.cX(),n=this.uX();(!s&&h>4||s&&h>16)&&(this.GC=vt(e-this.iX,h,this.GC),this.LC=vt(n-this.hX,h,this.LC),this.GC=Math.abs(this.GC)>1e-4?this.GC:0,this.LC=Math.abs(this.LC)>1e-4?this.LC:0,this.iX=e,this.hX=n,this.FC=this.XC);const r=this.aX(this.jD,this.qD,this.WD,this.JD),o=this.aX(this.KD,this.tX,this.QD,this.sX)-r;this.signalEmit({first:t,last:s,time:this.XC,centerClientX:this.nX,centerClientY:this.eX,dir:Math.sign(o),distance:o,deltaX:.5*e,deltaY:.5*n,velocityX:.5*this.GC,velocityY:.5*this.LC},i)}UC(t){this.WV&&(this.WV=!1,this.WC(!1,!0,t),this.signalEnd())}aX(t,s,i,h){const e=t-s,n=i-h;return Math.sqrt(e*e+n*n)}cX(){return Math.abs(this.KD-this.jD-(this.tX-this.qD))}uX(){return Math.abs(this.QD-this.WD-(this.sX-this.JD))}},yt=a(.4,0,.2,1.4),St="amp-image-viewer",Dt=["aria-label","aria-describedby","aria-labelledby"],kt=new Set(["AMP-IMG","AMP-ANIM","IMG"]),Ct=class extends t.BaseElement{constructor(t){super(t),this.gD=null,this.AD=null,this.MD=0,this.PD=0,this.lX=null,this.ED=null,this.fX=null,this.qX=null,this.bD=1,this.TD=1,this.ID=1,this.RD=1,this.VD=2,this.zC=0,this.BC=0,this.wD=0,this.yD=0,this.xD=0,this.SD=0,this.DD=0,this.kD=0,this.dX=null,this.CD=null,this.lD=null,this.Vi=null,this.QR=this.QR.bind(this)}buildCallback(){this.element.classList.add("i-amphtml-image-viewer");const t=function(t,s){const i=[];for(let s=t.firstElementChild;s;s=s.nextElementSibling)!(function(t){let s;return r(t)?s=t:u(t)&&(s=t.tagName),!!s&&s.toLowerCase().startsWith("i-")}(h=s)||h.nodeType===Node.ELEMENT_NODE&&(h.hasAttribute("placeholder")||h.hasAttribute("fallback")||h.hasAttribute("overflow")))&&i.push(s);var h;return i}(this.element);Q(1==t.length,"%s should have its target element as its one and only child",St),Q(this.JX(t[0]),"%s is not supported by %s",t[0].tagName,St),this.lD=t[0],nt(this.element).setOwner(this.lD,this.element)}layoutCallback(){if(this.Vi)return this.Vi;if(Z(this.element,"[i-amphtml-scale-animation]"))return i();const t=this.lD,s=!!this.gD,h=s?i():"IMG"===t.tagName?function(t){let s,i;if(function(t){return!!(t.complete||"complete"==t.readyState||ft(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}(t))return Promise.resolve(t);const h=ft(t);return h&&t.__AMP_MEDIA_LOAD_FAILURE_SRC===t.currentSrc?Promise.reject(t):new Promise(((e,n)=>{if(s=h?lt(t,"loadedmetadata",e,{capture:!0}):lt(t,"load",e),!t.tagName)return;let r=t;if(h&&!t.hasAttribute("src")&&(r=function(t,s){for(let i=t.lastElementChild;i;i=i.previousElementSibling)if(s(i))return i;return null}(t,(t=>"SOURCE"===t.tagName)),!r))return n(new Error("Media has no source."));i=lt(r,"error",n)})).then((()=>(i&&i(),t)),(()=>{s&&s(),function(t){ft(t)&&(t.__AMP_MEDIA_LOAD_FAILURE_SRC=t.currentSrc||!0);let s=t;throw s&&s.src&&(s=s.src),H().createError("Failed to load:",s)}(t)}))}(t):t.signals().whenSignal("load-end");return s||nt(this.element).scheduleLayout(this.element,t),this.Vi=h.then((()=>this.Au())).then((()=>this.KX())).then((()=>this.Nj())),this.Vi}pauseCallback(){this.Vi&&this.Vi.then((()=>{this.KX(),this.ZX()}))}resumeCallback(){this.Vi&&this.Vi.then((()=>{this.KX(),this.Nj()}))}unlayoutCallback(){return this.ZX(),this.Vi=null,function(t,s,i){const h=C.get(t);if(h&&(n(h,(t=>t.callback===i&&0===t.type)),0==h.length)){C.delete(t),x.delete(t);const s=t.ownerDocument.defaultView;s&&X(s).unobserve(t)}}(this.element,0,this.QR),!0}isLayoutSupported(t){return"fill"==t}getImageBox(){return this.ED}getImage(){return this.gD}getImageBoxWithOffset(){if(0==this.wD&&0==this.yD||!this.ED)return this.ED;const t=(this.bD-1)/2;return function(t,s,i){return 0==s&&0==i||0==t.width&&0==t.height?t:p(t.left+s,t.top+i,t.width,t.height)}((i=t,h=t,p((s=this.ED).left-s.width*i,s.top-s.height*h,s.width*(1+2*i),s.height*(1+2*h))),this.wD,this.yD);var s,i,h}JX(t){return kt.has(t.tagName)}XD(t){const s=(i=t,d(/^[\w-]+$/.test("img")),i.querySelector("img"));var i;this.measureElement((()=>{s?(this.MD=s.naturalWidth||t.offsetWidth,this.PD=s.naturalHeight||t.offsetHeight):(this.MD=t.offsetWidth,this.PD=t.offsetHeight)}))}Au(){if(this.gD)return i();this.gD=this.element.ownerDocument.createElement("img"),this.gD.classList.add("i-amphtml-image-viewer-image");const t=this.lD;return this.XD(t),this.AD=function(t){const s=t.getAttribute("srcset");if(s)return function(t){const s=[];let i;for(;i=N.exec(t);){const t=i[1];let h,e;if(i[2]){const t=i[3].toLowerCase();if("w"==t)h=parseInt(i[2],10);else{if("x"!=t)continue;e=parseFloat(i[2])}}else e=1;s.push({url:t,width:h,dpr:e})}return new $(s)}(s);const i=t.getAttribute("src");return m(i,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new $([{url:i,width:void 0,dpr:1}])}(t),function(t,s,i){const h=t.ownerDocument.defaultView;if(!h)return;let e=C.get(t);if(e||(e=[],C.set(t,e),X(h).observe(t)),!e.some((t=>t.callback===i&&0===t.type))){e.push({type:0,callback:i});const s=x.get(t);s&&setTimeout((()=>O(0,i,s)))}}(this.element,0,this.QR),this.mutateElement((()=>{var s,h;return w(this.gD,{top:0,left:0,width:0,height:0}),s=t,void 0===(h=!1)&&(h=s.hasAttribute("hidden")),h?s.removeAttribute("hidden"):s.setAttribute("hidden",""),this.element.appendChild(this.gD),"IMG"===t.tagName?(z(Dt,t,this.gD),i()):t.getImpl().then((t=>z(Dt,t.element,this.gD)))}))}QR(){Z(this.element,"[i-amphtml-scale-animation]")||this.KX()}sR(){var t;this.lX=(t=this.element.getBoundingClientRect(),p(Number(t.left),Number(t.top),Number(t.width),Number(t.height)));const s=this.MD/this.PD;let i=Math.min(this.lX.width/s,this.lX.height),h=Math.min(this.lX.height*s,this.lX.width);Math.abs(h-this.MD)<=16&&Math.abs(i-this.PD<=16)&&(h=this.MD,i=this.PD),this.ED=p(Math.round((this.lX.width-h)/2),Math.round((this.lX.height-i)/2),Math.round(h),Math.round(i));const e=this.lX.width/this.lX.height,n=Math.max(e/s,s/e);this.VD=Math.max(2,n),this.TD=this.bD=1,this.zC=this.wD=0,this.BC=this.yD=0,this.OD(this.bD)}KX(){return this.measureElement((()=>this.sR())).then((()=>{const t=this.gD;return this.mutateElement((()=>{w(t,{top:b(this.ED.top),left:b(this.ED.left),width:b(this.ED.width),height:b(this.ED.height)}),this.YD()}),t)})).then((()=>this.zA()))}zA(){if(!this.AD)return i();this.ID=Math.max(this.ID,this.bD);const t=Math.max(this.ED.width*this.ID,this.MD),s=this.AD.select(t,class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}}.getDevicePixelRatio());return s==this.gD.getAttribute("src")?i():this.mutateElement((()=>{this.gD.setAttribute("src",s)}),this.gD)}ZX(){this.dX&&(this.dX.cleanup(),this.dX=null)}Nj(){this.dX=Mt.get(this.element),this.dX.onGesture(It,(t=>{const{data:s}=t,i=1==this.bD?this.VD:this.RD,h=this.lX.width/2-s.clientX,e=this.lX.height/2-s.clientY;this.ZD(i,h,e,!0).then((()=>this.LD()))})),this.dX.onGesture(gt,(t=>{this.QX(t.data.target)})),this.dX.onGesture(wt,(t=>{const{data:s}=t;this.sZ(s.centerClientX,s.centerClientY,s.deltaX,s.deltaY),s.last&&this.hZ(s.centerClientX,s.centerClientY,s.deltaX,s.deltaY,s.velocityY,s.velocityY)})),this.dX.onGesture(bt,(t=>{const{data:s}=t;this.BX(s.centerClientX,s.centerClientY,s.deltaX,s.deltaY,s.dir),s.last&&this.LD()}))}QX(t){const s=function(t,s,i,h){const e={detail:null};return Object.assign(e,{bubbles:!0}),new t.CustomEvent("click",e)}(this.win);t.dispatchEvent(s)}cZ(){this.fX=this.dX.onGesture(Vt,(t=>{const{data:s}=t;this.zD(s.deltaX,s.deltaY,!1),s.last&&this.$D(s.velocityX,s.velocityY)})),this.qX=this.dX.onPointerDown((()=>{this.CD&&this.CD.halt()}))}uZ(){this.fX&&(this.fX(),this.fX=null,this.dX.removeGesture(Vt)),this.qX&&(this.qX(),this.qX=null)}BD(t,s){return B(t,this.RD,this.VD,s?.25:0)}UD(t,s){return B(t,this.xD,this.DD,s&&this.bD>1?.25*this.lX.width:0)}GD(t,s){return B(t,this.SD,this.kD,s?.25*this.lX.height:0)}OD(t){let s=0,i=0;const h=this.lX.height-this.ED.height*t;h>=0?i=s=0:(i=h/2,s=-i);let e=0,n=0;const r=this.lX.width-this.ED.width*t;r>=0?n=e=0:(n=r/2,e=-n),this.xD=n,this.SD=i,this.DD=e,this.kD=s}YD(){var t,s,i;w(this.gD,{transform:(s=this.wD,i=this.yD,(null==i?`translate(${y(s,b)})`:`translate(${y(s,b)}, ${y(i,b)})`)+" "+(t=this.bD,`scale(${t})`))})}zD(t,s,i){const h=this.UD(this.zC+t,!1),e=this.GD(this.BC+s,!1);this.FD(this.bD,h,e,i)}$D(t,s){this.CD=Et(this.gD,this.wD,this.yD,t,s,((t,s)=>{const i=this.UD(t,!1),h=this.GD(s,!1);return!(Math.abs(i-this.wD)<1&&Math.abs(h-this.yD)<1||(this.FD(this.bD,i,h,!1),0))})),this.CD.thenAlways((()=>(this.CD=null,this.HD())))}BX(t,s,i,h,e){this.aZ(t,s,i,h,e)}sZ(t,s,i,h){const e=Math.abs(h)>Math.abs(i)?Math.sign(h):Math.sign(-i);this.aZ(t,s,i,h,e)}aZ(t,s,i,h,e){if(0==e)return;const n=L(i,h),r=this.TD*(1+e*n/100),o=this.lX.width/2-t,c=this.lX.height/2-s;i=Math.min(o,o*(n/100)),h=Math.min(c,c*(n/100)),this.ZD(r,i,h,!1)}ZD(t,s,i,h){const e=this.BD(t,!0);if(e==this.bD)return;this.OD(e);const n=this.UD(this.zC+s*e,!1),r=this.GD(this.BC+i*e,!1);return this.FD(e,n,r,h)}hZ(t,s,h,e,n,r){let o;return o=0==n&&0==r?i():Et(this.gD,h,e,n,r,((i,h)=>(this.sZ(t,s,i,h),!0))).thenAlways(),o.then((()=>{this.LD()}))}LD(){const t=this.bD>this.TD;return this.HD().then((()=>{t&&this.zA(),this.bD>1?this.cZ():this.uZ()}))}FD(t,s,h,e){const n=t-this.bD,r=(o=this.wD,c=this.yD,L(s-o,h-c));var o,c;let u,a=0;if(e){const t=250;a=Math.min(t,Math.max(t*r*.01,t*Math.abs(n)))}if(a>16&&e){const i=U(this.bD,t),e=U(this.wD,s),n=U(this.yD,h);u=ut.animate(this.gD,(t=>{this.bD=i(t),this.wD=e(t),this.yD=n(t),this.YD()}),a,yt).thenAlways((()=>{this.bD=t,this.wD=s,this.yD=h,this.YD()}))}else this.bD=t,this.wD=s,this.yD=h,this.YD(),u=e?i():void 0;return u}HD(){const t=this.BD(this.bD,!1);t!=this.bD&&this.OD(t);const s=this.UD(this.wD/this.bD*t,!1),i=this.GD(this.yD/this.bD*t,!1);return this.FD(t,s,i,!0).then((()=>{this.TD=this.bD,this.zC=this.wD,this.BC=this.yD}))}};t.registerElement(St,Ct,".i-amphtml-image-viewer-image{position:absolute;-o-object-fit:contain;object-fit:contain}.i-amphtml-image-viewer{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-viewer>amp-img{min-width:1px;min-height:1px}\n/*# sourceURL=/extensions/amp-image-viewer/0.1/amp-image-viewer.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-viewer-0.1.mjs.map