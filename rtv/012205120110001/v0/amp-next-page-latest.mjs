;
(self.AMP=self.AMP||[]).push({m:1,v:"2205120110001",n:"amp-next-page",ev:"1.0",l:!0,f:function(t,i){(()=>{function i(t){return t?Array.prototype.slice.call(t):[]}var{isArray:e}=Array,{hasOwnProperty:n,toString:s}=Object.prototype;function r(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function o(t,i){return n.call(t,i)}function h(t,i,e,n,s,r,o,h,u,a,c){return t}function u(t,i){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==i||i(t),null}}function a(t){return(t.ownerDocument||t).defaultView}function c(t,i){return t.replace(/^|,/g,`$&${i} `)}function l(t){return CSS.escape(t)}function p(t){h(/^[\w-]+$/.test(t))}function f(t,i){return t.querySelector(c(i,":scope"))}function m(t,i){return p(i),f(t,`> [${i}]`)}function d(t,i){return p(i),e=`> ${i}`,t.querySelectorAll(c(e,":scope"));var e}function g(t){var i;null===(i=t.parentElement)||void 0===i||i.removeChild(t)}function v(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function P(t,i){t.insertBefore(i,t.firstChild)}function _(t){if(Node.prototype.getRootNode)return t.getRootNode();let i;for(i=t;i.parentNode&&(!(e=i)||"I-AMPHTML-SHADOW-ROOT"!=e.tagName&&(11!=e.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(e)));i=i.parentNode);var e;return i}function b(t){if(!t)return null;const i=t.match(/^(.*)\/(.*)-([0-9.]+|latest)(\.max)?\.(?:js|mjs)$/i),e=i?i[2]:void 0,n=i?i[3]:void 0;return e&&n?{extensionId:e,extensionVersion:n}:null}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var x,w=self.__AMP_LOG;function A(t,i){throw new Error("failed to call initLogConstructor")}function R(t){return w.user||(w.user=E()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(w.user.win,t)?w.userForEmbed||(w.userForEmbed=E()):w.user}function E(t){return A()}function y(){return w.dev||(w.dev=A())}function I(t,i,e,n,s,r,o,h,u,a,c){return t}function T(t,i,e,n,s,r,o,h,u,a,c){return R().assert(t,i,e,n,s,r,o,h,u,a,c)}function M(){return x||(x=Promise.resolve(void 0))}function S(t,i){return $(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function V(t,i){return $(j(N(t)),i)}function k(t,i){const e=j(N(t));return B(e,i)?$(e,i):null}function O(t,i){return C(j(t),i)}function N(t){return t.nodeType?(i=a(t),S(i,"ampdoc")).getAmpDoc(t):t;var i}function j(t){const i=N(t);return i.isSingleDoc()?i.win:i}function $(t,i){I(B(t,i));const e=L(t)[i];return e.obj||(I(e.ctor),I(e.context),e.obj=new e.ctor(e.context),I(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function C(t,i){const e=L(t)[i];return e?e.promise?e.promise:($(t,i),e.promise=Promise.resolve(e.obj)):null}function L(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function D(t){return"function"==typeof t.dispose}function U(t,i){if(D(i))try{(function(t){return I(D(t)),t})(i).dispose()}catch(i){y().error("SERVICE","failed to dispose service",t,i)}}function B(t,i){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!e||!e.ctor)}function z(t,i,e,n){const s=O(t,i);if(s)return s;const r=N(t);return r.whenExtensionsKnown().then((()=>{const t=r.getExtensionVersion(e);return t?S(r.win,"extensions").waitForExtension(e,t):null})).then((e=>e?n?O(t,i):function(t,i){return function(t,i){const e=C(t,i);if(e)return e;const n=L(t);return n[i]=function(){const t=new class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{promise:i,reject:e,resolve:n}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:n,reject:e,context:null,ctor:null}}(),n[i].promise}(j(t),i)}(t,i):null))}var H,F,q=t=>function(t,i,e){const n=k(t,i);return n?Promise.resolve(n):z(t,i,"amp-bind")}(t,"bind"),W=t=>V(t,"mutator"),J=t=>V(t,"viewer"),Y=t=>S(t,"vsync"),Z=t=>V(t,"viewport"),K=t=>S(t,"xhr"),Q="prerender",G="visible",X="hidden";function tt(t){const i=t.ownerDocument||t;return H&&H.ownerDocument===i||(H=i.createElement("div")),it}function it(t){return function(t,i){h(1===i.length),t.innerHTML=i[0];const e=t.firstElementChild;return h(e),h(!e.nextElementSibling),t.removeChild(e),e}(H,t)}var et=["Webkit","webkit","Moz","moz","ms","O","o"];function nt(t,i,e,n,s){const o=function(t,i,e){if(i.startsWith("--"))return i;F||(F=r());let n=F[i];if(!n||e){if(n=i,void 0===t[i]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),s=function(t,i){for(let e=0;e<et.length;e++){const n=et[e]+i;if(void 0!==t[n])return n}return""}(t,e);void 0!==t[s]&&(n=s)}e||(F[i]=n)}return n}(t.style,i,s);if(!o)return;const h=n?e+n:e;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return et.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(o),h)}function st(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}function rt(t,i,e={},n=!0){var s;(s=t,z(s,"amp-analytics-instrumentation","amp-analytics")).then((s=>{s&&s.triggerEventForTarget(t,i,e,n)}))}var ot={INSIDE:"inside",TOP:"top",BOTTOM:"bottom"};function ht(t,i){return!(!t||!i)&&t.left==i.left&&t.top==i.top&&t.width==i.width&&t.height==i.height}function ut(t){!function(t,i,e,n){const s=N(t),r=j(s);!function(t,i,e,n,s,r){const o=L(t);let h=o[e];h||(h=o[e]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),h.ctor||(h.ctor=n,h.context=i,h.sharedInstance=!1,h.resolve&&$(t,e))}(r,s,i,class{constructor(t){this.Ni=t,this.i=t.win,this.tR=[],this.ar=Y(this.i),this.Uu=Z(t),this.F_=[],this.iR=!1,this.sR=!1,this.nR=!1,this.hR=function(t,i,e){let n=0,s=0,r=null;function o(){n=0;const h=e-(t.Date.now()-s);var u;h>0?n=t.setTimeout(o,h):(u=r,r=null,i.apply(null,u))}return function(...i){s=t.Date.now(),r=i,n||(n=t.setTimeout(o,e))}}(this.i,(()=>{this.iR=!1}),500)}observe(t,i,e){const n=new class{constructor(t,i,e,n){this.element=i,this.Me=n,this.fidelity=e,this.turn=0==e?Math.floor(4*Math.random()):0,this.eR=null,this.Uu=Z(t)}Ee(t){const i=this.eR;if(i&&ht(i.positionRect,t.positionRect)&&ht(i.viewportRect,t.viewportRect))return;I(t.positionRect);const e=t.positionRect;var n,s;t.relativePos=(n=e,s=t.viewportRect,n.top<s.top?ot.TOP:n.bottom>s.bottom?ot.BOTTOM:ot.INSIDE),function(t,i){return t.top<=i.bottom&&i.top<=t.bottom&&t.left<=i.right&&i.left<=t.right}(e,t.viewportRect)?(this.eR=t,this.Me(t)):this.eR&&(this.eR=null,t.positionRect=null,this.Me(t))}update(t){if(!t){if(0!=this.turn)return void this.turn--;0==this.fidelity&&(this.turn=4)}const i=this.Uu.getSize(),e={left:0,top:0,width:n=i.width,height:s=i.height,bottom:0+s,right:0+n,x:0,y:0};var n,s;this.Uu.getClientRectAsync(this.element).then((t=>{this.Ee({positionRect:t,viewportRect:e,relativePos:null})}))}}(this.Ni,t,i,e);return this.tR.push(n),this.nR||this.rR(),n.update(),()=>{for(let t=0;t<this.tR.length;t++)if(this.tR[t]==n)return void this.oR(t)}}unobserve(t){for(let i=0;i<this.tR.length;i++)if(this.tR[i].element==t)return void this.oR(i);y().error("POSITION_OBSERVER","cannot unobserve unobserved element")}oR(t){this.tR.splice(t,1),0==this.tR.length&&this.lR()}rR(){this.nR=!0,this.F_.push(this.Uu.onScroll((()=>{this.uR()}))),this.F_.push(this.Uu.onResize((()=>{this.cR()})))}lR(){for(this.nR=!1;this.F_.length;)this.F_.pop()()}updateAllEntries(t){for(let i=0;i<this.tR.length;i++)this.tR[i].update(t)}uR(){this.hR(),this.iR=!0,this.sR||this.aR()}cR(){this.updateAllEntries(!0)}aR(){this.updateAllEntries(),this.sR=!0,this.iR?this.ar.measure((()=>{this.aR()})):this.sR=!1}})}(t,"position-observer")}var at,ct=class{constructor(t,i){this.Di=t,this.RQ=null,this.TQ=null,this.callback=i}get top(){return this.RQ}get bottom(){return this.TQ}observe(t,i){const e=t.ownerDocument.createElement("div");e.classList.add("i-amphtml-next-page-document-top-sentinel");const n=t.ownerDocument.createElement("div");n.classList.add("i-amphtml-next-page-document-bottom-sentinel"),i.insertBefore(e,t),i.insertBefore(n,t.nextSibling),this.Di.getPositionObserver().observe(e,0,(t=>this.SQ(t))),this.Di.getPositionObserver().observe(n,0,(t=>this.VQ(t)))}SQ(t){this.RQ=t.relativePos,this.Di.updateRelativePos(this)}VQ(t){this.TQ=t.relativePos,this.Di.updateRelativePos(this)}usesSentinel(){return!0}},lt=class extends ct{constructor(t,i,e){super(t,i),this.NQ=e}usesSentinel(){return!1}get nextPageEl(){return this.NQ}},pt="amp-next-page-hidden",ft=class{constructor(t,i){this.x_=t,this.mk=i.title,this.hi=i.url,this.jQ=i.url,this.gD=i.image,this.$Q=null,this.hf=null,this.nN=null,this.Ai=1,this.D=Q,this.CQ=2}get url(){return this.hi}set url(t){this.hi=t}get initialUrl(){return this.jQ}get image(){return this.gD}get title(){return this.mk}get relativePos(){return this.CQ}get document(){if(this.$Q)return this.$Q.ampdoc.getRootNode()}get container(){return this.hf}get shadowDoc(){return this.$Q}set relativePos(t){this.CQ=t}is(t){return this.Ai===t}isLoaded(){return 3===this.Ai||5===this.Ai||6===this.Ai}isVisible(){return this.isLoaded()&&this.D===G}setVisibility(t){this.isLoaded()&&t!=this.D&&(this.is(6)&&t===G&&this.resume(),this.D=t,this.$Q&&(this.$Q.setVisibilityState(t),this.$Q.ampdoc.getBody().classList.toggle("amp-next-page-visible",this.isVisible()),this.$Q.ampdoc.getBody().classList.toggle(pt,!this.isVisible())))}pause(){return this.$Q?this.$Q.close().then((()=>this.x_.closeDocument(this).then((()=>{this.$Q=null,this.D=X,this.Ai=6})))):M()}resume(){return this.LQ()}fetch(){return 5===this.Ai||2===this.Ai||3===this.Ai||4===this.Ai?M():(this.Ai=2,this.x_.fetchPageDocument(this).then((t=>(this.Ai=3,this.nN=t,this.hf=this.x_.createDocumentContainerForPage(this),this.LQ()))).catch((()=>{this.Ai=4})))}LQ(){return this.x_.attachDocumentToPage(this,I(this.nN),this.is(6)).then((t=>{t?(this.Ai=5,this.$Q=t,this.is(6)||this.x_.setLastFetchedPage(this)):this.Ai=4}))}},mt=class extends ft{constructor(t,i,e,n,s){super(t,i),this.Ai=e,this.D=n,this.Zh=s}get document(){return this.Zh}},dt=(()=>self.AMP.config.urls)(),gt=new Set(["c","v","a","ad"]),vt=t=>"string"==typeof t?Pt(t):t;function Pt(t,i){return at||(at=self.document.createElement("a")),function(t,i,e){return t.href="",new URL(i,t.href)}(at,t)}function _t(t){if(!function(t){return dt.cdnProxyRegex.test(vt(t).origin)}(t=vt(t)))return t.href;const i=t.pathname.split("/"),e=i[1];T(gt.has(e),"Unknown path prefix in url %s",t.href);const n=i[2],s="s"==n?"https://"+decodeURIComponent(i[3]):"http://"+decodeURIComponent(n);return T(s.indexOf(".")>0,"Expected a . in origin %s",s),i.splice(1,"s"==n?3:2),s+i.join("/")+function(t,i){if(!t||"?"==t)return"";const e=new RegExp("[?&](amp_(js[^&=]*|gsa|r|kit)|usqp)\\b[^&]*","g"),n=t.replace(e,"").replace(/^[?&]/,"");return n?"?"+n:""}(t.search)+(t.hash||"")}function bt(t){return Pt(_t(t)).origin}function xt(t,i){const e=Pt(t),{origin:n}=Pt(i),s=bt(i);return T(e.origin===n||e.origin===s,"Invalid page URL supplied to amp-next-page, pages must be from the same origin as the current document"),e}var wt='.i-amphtml-next-page-document{overflow:hidden}.i-amphtml-next-page-document:not(.amp-next-page-visible) [i-amphtml-fixedid]{display:none}.i-amphtml-next-page-document.amp-next-page-visible{opacity:1;overflow:visible}.i-amphtml-next-page-document:after,.i-amphtml-next-page-document:before{content:" ";display:table}.i-amphtml-next-page-placeholder{background:#eee}.amp-next-page-separator{border-bottom:1px solid rgba(0,0,0,0.12)}.amp-next-page-links{border-top:1px solid rgba(0,0,0,0.1);margin-top:16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.amp-next-page-link{border-bottom:1px solid rgba(0,0,0,0.1);display:block;overflow:auto;padding:10px 0;text-decoration:none}.amp-next-page-image{width:72px;height:72px;float:left;margin:0 10px;background-size:cover;background-position:50%}.amp-next-page-text{position:relative;margin:5px 30px 5px 0;color:#3c4043;font-size:17px}\n/*# sourceURL=/extensions/amp-next-page/1.0/amp-next-page.css*/',At={NONE:0,OPT_IN:1,ALL:2};var Rt,Et,yt="render-start",It="none";function Tt(){return void 0===Et&&(Et=St()!=It&&(Mt(Element.prototype.attachShadow)||Mt(Element.prototype.createShadowRoot))),Et}function Mt(t){return!!t&&-1!=t.toString().indexOf("[native code]")}function St(t){return void 0===Rt&&(i=t||Element,Rt=i.prototype.attachShadow?"v1":i.prototype.createShadowRoot?"v0":It),Rt;var i}function Vt(t,i,e){var n="";return t&&Array.prototype.forEach.call(t,(function(t){if(t.selectorText&&t.style&&void 0!==t.style.cssText)n+=function(t,i,e){var n=[];return t.split(",").forEach((function(t){t=t.trim(),e&&(t=e(t)),function(t,i){var e=function(t){return t=t.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),new RegExp("^("+t+")"+Nt,"m")}(i);return!t.match(e)}(t,i)&&(t=function(t,i){return function(t,i){return t.match($t)?(t=t.replace(jt,i)).replace($t,i+" "):i+" "+t}(t,i)}(t,i)),n.push(t)})),n.join(", ")}(t.selectorText,i,e)+" {\n\t",n+=function(t){var i=t.style.cssText;t.style.content&&!t.style.content.match(/['"]+|attr/)&&(i=i.replace(/content:[^;]*;/g,"content: '"+t.style.content+"';"));var e=t.style;for(var n in e)"initial"===e[n]&&(i+=n+": initial; ");return i}(t)+"\n}\n\n";else if(t.type===CSSRule.MEDIA_RULE)n+="@media "+t.media.mediaText+" {\n",n+=Vt(t.cssRules,i),n+="\n}\n\n";else try{t.cssText&&(n+=t.cssText+"\n\n")}catch(t){}})),n}var kt="-shadowcsshost",Ot=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",Nt=(new RegExp("("+kt+Ot,"gim"),new RegExp("(-shadowcsscontext"+Ot,"gim"),"([>\\s~+[.,{:][\\s\\S]*)?$"),jt=kt+"-no-combinator",$t=new RegExp(kt,"gim");function Ct(t,i,e,n,s){const o=t.getHeadNode(),h=function(t,i,e,n){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=r());const o=!e&&n&&"amp-custom"!=n&&"amp-keyframes"!=n,h=e?"amp-runtime":o?`amp-extension=${n}`:null;if(h){const e=Lt(t,s,h);if(e)return"STYLE"==e.tagName&&e.textContent!==i&&(e.textContent=i),e}const u=(t.ownerDocument||t).createElement("style");u.textContent=i;let a=null;return e?u.setAttribute("amp-runtime",""):o?(u.setAttribute("amp-extension",n||""),a=Lt(t,s,"amp-runtime")):(n&&u.setAttribute(n,""),a=t.lastChild),function(t,i,e=null){if(!e)return void P(t,i);const n=e.nextSibling;t.insertBefore(i,n)}(t,u,a),h&&(s[h]=u),u}(o,function(t,i){const e=t.__AMP_CSS_TR;return e?e(i):i}(o,i),n||!1,s||null);if(e){const i=t.getRootNode();if(Dt(i,h))return e(h),h;const n=setInterval((()=>{Dt(i,h)&&(clearInterval(n),e(h))}),4)}return h}function Lt(t,i,e){if(i[e])return i[e];const n=t.querySelector(`style[${e}], link[${e}]`);return n?(i[e]=n,n):null}function Dt(t,i){const e=t.styleSheets;for(let t=0;t<e.length;t++)if(e[t].ownerNode==i)return!0;return!1}function Ut(t){d(t,"noscript").forEach(g)}new RegExp("-shadowcsscontext","gim");var Bt,zt=/[^\.\-\_0-9a-zA-Z]/,Ht=/[^\-\_0-9a-zA-Z]/;function Ft(t,i,e){const n=t.ownerDocument;let s;if(Tt())s=n.importNode(i,e);else{s=n.createElement("amp-body"),function(t,i){const{style:e}=t;h(!0),h(!e.display),e.display="block"}(s);for(let t=0;t<i.attributes.length;t++)s.setAttribute(i.attributes[0].name,i.attributes[0].value);if(e)for(let t=i.firstChild;t;t=t.nextSibling)s.appendChild(n.importNode(t,!0))}nt(s,"position","relative");const r=t.body;return r&&t.removeChild(r),t.appendChild(s),Object.defineProperty(t,"body",{configurable:!0,value:s}),s}function qt(t){return t.replace(/(html|body)/g,Wt)}function Wt(t,i,e,n){const s=n.charAt(e-1),r=n.charAt(e+t.length);return s&&!zt.test(s)||r&&!Ht.test(r)?t:"amp-"+t}function Jt(t,i){const e=t.createElement("style");e.textContent=i;try{return(t.head||t.documentElement).appendChild(e),e.sheet?e.sheet.cssRules:null}finally{e.parentNode&&e.parentNode.removeChild(e)}}var Yt="multidoc-manager",Zt=['<div class=amp-next-page-separator aria-label="Next article separator" tabindex=0></div>'],Kt=['<div class=amp-next-page-links aria-label="Read more articles"></div>'],Qt=["<a class=amp-next-page-link><img ref=image class=amp-next-page-image> <span ref=title class=amp-next-page-text></span></a>"],Gt="amp-next-page",Xt="i-amphtml-next-page-shadow-root",ti="i-amphtml-next-page-placeholder",ii=()=>M(),ei=class extends t.BaseElement{constructor(t){super(t),this.DQ=null}isLayoutSupported(t){return"container"===t}buildCallback(){return this.DQ=V(this.element,"next-page"),this.DQ.build(this.element)}};t.registerServiceForDoc("next-page",class{constructor(t){this.Ni=t,this.i=t.win,this.tp=this.i.document,this.Uu=Z(t),this.Fe=J(t),this.oc=W(t),this.tM=V(t,"templates"),this.UQ=null,this.BQ=null,this.zQ=ii,this.HQ=!1,this.FQ=null,this.qQ=null,this.WQ=null,this.JQ=null,this.vn=null,this.UR=null,this.YQ,this.ZQ=null,this.KQ=null,this.QQ=null,this.GQ={},this.XQ=!1,this.t0=1/0,this.i0=null,this.ai=null,this.ri=new Promise((t=>{this.ai=t}))}isBuilt(){return!!this.YQ}build(n){if(this.isBuilt())return M();this.Ni.getBody().lastElementChild,this.qQ=n,this.i0=this.e0().getAttribute("src"),this.XQ=this.e0().hasAttribute("deep-parsing")?"false"!==this.e0().getAttribute("deep-parsing"):!this.i0,this.t0=this.e0().hasAttribute("max-pages")?parseInt(this.e0().getAttribute("max-pages"),10):1/0,this.UQ=this.n0(n),this.BQ=this.s0(n),this.KQ=this.createHostPage(),this.QQ=this.KQ,this.toggleHiddenAndReplaceableElements(this.tp),P(this.qQ,this.BQ),this.vn=V(this.Ni,"history"),this.UR=(t=>V(this.Ni,"navigation"))(),this.JQ=new class{constructor(t,i,e,n){this.win=t,this.gh=i,this.sa=e,this.Ie=n,this.pa=[]}ma(n,r,o,h){o=o||Object.create(null),this._a(),nt(n,"visibility","hidden");const u=function(t){const e=a(t),n=t.shadowRoot||t.__AMP_SHADOW_ROOT;if(n)return n.innerHTML="",n;let s;const r=St();if("v1"==r?(s=t.attachShadow({mode:"open"}),s.styleSheets||Object.defineProperty(s,"styleSheets",{get:function(){const t=[];return s.childNodes.forEach((i=>{"STYLE"===i.tagName&&t.push(i.sheet)})),t}})):s="v0"==r?t.createShadowRoot():function(t){const e=t.ownerDocument;t.classList.add("i-amphtml-shadow-host-polyfill");const n=e.createElement("style");n.textContent=".i-amphtml-shadow-host-polyfill>:not(i-amphtml-shadow-root){display:none!important}",t.appendChild(n);const s=e.createElement("i-amphtml-shadow-root");return t.appendChild(s),t.__AMP_SHADOW_ROOT=s,Object.defineProperty(t,"shadowRoot",{enumerable:!0,configurable:!0,value:s}),s.host=t,s.getElementById=function(t){const i=l(t);return s.querySelector(`#${i}`)},Object.defineProperty(s,"styleSheets",{get:()=>e.styleSheets?i(e.styleSheets).filter((t=>s.contains(t.ownerNode))):[]}),s}(t),!Tt()){const t=`i-amphtml-sd-${e.Math.floor(1e4*e.Math.random())}`;s.id=t,s.host.classList.add(t),o=t=>function(t,i){return function(t,i){const e=I(t.id),n=t.ownerDocument;let s=null;try{s=Jt(n.implementation.createHTMLDocument(""),i)}catch(t){}if(!s)try{s=Jt(n,i)}catch(t){}return s?Vt(s,`.${e}`,qt):i}(t,i)}(s,t),s.__AMP_CSS_TR=o}var o;return s}(n);u.AMP&&this.Aa(u);const c={};u.AMP=c,c.url=r;const{origin:p}=Pt(r),f=this.gh.installShadowDoc(r,u,{params:o});c.ampdoc=f,Ct(f,t.combinedCss,null,!0),t.installAmpdocServices(f);const m=J(f);let d;return c.setVisibilityState=function(t){f.overrideVisibilityState(t)},c.postMessage=m.receiveMessage.bind(m),c.onMessage=function(t){d=t},m.setMessageDeliverer(((t,i,e)=>{var n;return"broadcast"==t?(this.ga(i,u),e?M():void 0):null===(n=d)||void 0===n?void 0:n(t,i,e)}),p),c.close=()=>this.Aa(u),c.getState=t=>q(u).then((i=>i?i.getState(t):Promise.reject("amp-bind is not available in this document"))),c.setState=t=>q(u).then((i=>{return i?"string"==typeof t?i.setStateWithExpression(t,{}):(n=t,"[object Object]"===s.call(n)||e(t)?i.setStateWithObject(t):Promise.reject("Invalid state")):Promise.reject("amp-bind is not available in this document");var n})),h(c,u,f).then((()=>{f.setReady(),f.signals().signal(yt),nt(n,"visibility","visible")})),this.pa.includes(u)||this.pa.push(u),c}attachShadowDoc(t,i,e,n){return R().assertString(e),this.ma(t,e,n,((e,n,s)=>{if(this.Pa(s,n,i),i.body){const t=Ft(n,i.body,!0);t.classList.add("amp-shadow"),s.setBody(t)}return setTimeout((()=>{s.signals().signal(yt),nt(t,"visibility","visible")}),50),M()}))}attachShadowDocAsStream(t,i,e){return R().assertString(i),this.ma(t,i,e,((i,e,n)=>{let s=!1;const r=function(t){return void 0===Bt&&(Bt=function(t){return!(!t.document.implementation||"function"!=typeof t.document.implementation.createHTMLDocument||(i=t,S(i,"platform")).isFirefox());var i}(t)),Bt}(o=this.win)?new class{constructor(t){this.va=t.document.implementation.createHTMLDocument(""),this.va.open(),this.ar=Y(t),this.Ea=this.Ta.bind(this),this.Ia=null,this.Ma=null,this.Ra=null,this.ya=!1,this.wa=M(),this.ba=!1,this.Va=null}onBody(t){this.Ia=t}onBodyChunk(t){this.Ma=t}onEnd(t){this.Ra=t}write(t){if(this.ba)throw new Error("closed already");return t&&this.va.write(t),this.ps(),this.wa}close(){return this.va.close(),this.ba=!0,this.ps(),this.wa}abort(t){throw new Error("Not implemented")}releaseLock(){throw new Error("Not implemented")}get closed(){throw new Error("Not implemented")}get desiredSize(){throw new Error("Not implemented")}get ready(){throw new Error("Not implemented")}ps(){h(this.Ia&&this.Ma&&this.Ra),this.ya||(this.ya=!0,this.ar.mutate(this.Ea))}Ta(){if(this.ya=!1,!this.Va&&this.va.body&&(this.Va=this.Ia(this.va)),this.Va){const t=this.va.body,i=h(this.Va);let e=0;for(Ut(t);t.firstChild;)e++,i.appendChild(t.firstChild);e>0&&this.Ma()}this.ba&&this.Ra()}}(o):new class{constructor(t){this.Sa=[],this.ar=Y(t),this.Ia=null,this.Ma=null,this.Ra=null,this.wa=M(),this.ba=!1}onBody(t){this.Ia=t}onBodyChunk(t){this.Ma=t}onEnd(t){this.Ra=t}write(t){if(h(this.Ia&&this.Ma&&this.Ra),this.ba)throw new Error("closed already");return t&&this.Sa.push(t),this.wa}close(){return h(this.Ia&&this.Ma&&this.Ra),this.ba=!0,this.ar.mutate((()=>this.vr())),this.wa}abort(t){throw new Error("Not implemented")}releaseLock(){throw new Error("Not implemented")}get closed(){throw new Error("Not implemented")}get desiredSize(){throw new Error("Not implemented")}get ready(){throw new Error("Not implemented")}vr(){const t=this.Sa.join(""),i=(new DOMParser).parseFromString(t,"text/html");if(i.body){const t=i.body,e=this.Ia(i);let n=0;for(Ut(t);t.firstChild;)n++,e.appendChild(t.firstChild);n>0&&this.Ma()}this.Ra()}}(o);var o;return i.writer=r,r.onBody((t=>{this.Pa(n,e,t);const i=Ft(e,t.body,!1);return i.classList.add("amp-shadow"),n.setBody(i),i})),r.onBodyChunk((()=>{s||(s=!0,setTimeout((()=>{n.signals().signal(yt),nt(t,"visibility","visible")}),50))})),new Promise((t=>{r.onEnd((()=>{t(),i.writer=null}))}))}))}Pa(t,i,e){if(e.head){i.AMP.head=e.head;const n={},s=d(this.win.document.head,"link");for(let t=0;t<s.length;t++){const i=s[t].getAttribute("href");i&&(n[i]=!0)}for(let s=e.head.firstElementChild;s;s=s.nextElementSibling){const{tagName:e}=s,r=s.getAttribute("name"),o=s.getAttribute("rel");switch(e){case"TITLE":i.AMP.title=s.textContent;break;case"META":s.hasAttribute("charset")||"viewport"==r||r&&t.setMetaByName(r,s.getAttribute("content")||"");break;case"LINK":const e=s.getAttribute("href");if("canonical"==o)i.AMP.canonicalUrl=e;else if("stylesheet"==o)if(n[e])Ct(t,`@import "${e}"`,null,!1);else{n[e]=!0;const t=this.win.document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),this.win.document.head.appendChild(t)}break;case"STYLE":s.hasAttribute("amp-boilerplate")||(s.hasAttribute("amp-custom")?Ct(t,s.textContent,null,!1,"amp-custom"):s.hasAttribute("amp-keyframes")&&Ct(t,s.textContent,null,!1,"amp-keyframes"));break;case"SCRIPT":if(s.hasAttribute("src")){const i=s.getAttribute("src"),e=b(i),n=s.getAttribute("custom-element"),r=s.getAttribute("custom-template"),o=n||r;e&&(o?this.sa.installExtensionForDoc(t,o,e.extensionVersion):s.hasAttribute("data-amp-report-test")||R().error(Yt,"- unknown script: ",s,i))}else-1==(s.getAttribute("type")||"application/javascript").indexOf("javascript")?i.appendChild(this.win.document.importNode(s,!0)):s.hasAttribute("amp-onerror")||R().error(Yt,"- unallowed inline javascript: ",s);break;case"NOSCRIPT":break;default:R().error(Yt,"- UNKNOWN head element:",s)}}}t.setExtensionsKnown()}ga(t,i){this._a(),this.pa.forEach((e=>{if(e==i)return;const n=J(e.AMP.ampdoc);this.Ie.delay((()=>{n.receiveMessage("broadcast",t,!1)}),0)}))}Aa(t){this.xa(t);const i=t.AMP;delete t.AMP;const{ampdoc:e}=i;return e.overrideVisibilityState("inactive"),function(t){!function(t){const i=L(t);for(const t in i){if(!Object.prototype.hasOwnProperty.call(i,t))continue;const e=i[t];e.sharedInstance||(e.obj?U(t,e.obj):e.promise&&e.promise.then((i=>U(t,i))))}}(t)}(e),this.Ie.timeoutPromise(15,new this.win.Promise((t=>{O(e,"resources").then((i=>{i?i.onNextPass(t):t()}))})),"Timeout reached waiting for visibility state change callback").catch((t=>{}))}xa(t){const i=this.pa.indexOf(t);-1!=i&&this.pa.splice(i,1)}Oa(t){this.Ie.delay((()=>{this.Aa(t)}),0)}_a(){this.pa.forEach((t=>{t.host&&function(t){const i=t.isConnected;if(void 0!==i)return i;let e=t;for(;e=_(e),e.host;)e=e.host;return e.nodeType===Node.DOCUMENT_NODE}(t.host)||(this.xa(t),this.Oa(t))}))}}(this.i,S(this.i,"ampdoc"),(t=>S(t,"extensions"))(this.i),$(this.i,"timer")),this.WQ=new class{constructor(t){this.Ni=t,this.E_=[],this.Fx=0,this.cz=-1,this.r0=null,this.Uu=Z(t),this.o0=0,this.h0=!1,this.oc=W(t);const i=function(t,i,e){let n=0,s=null;function r(e){s=null,n=t.setTimeout(o,200),i.apply(null,e)}function o(){n=0,s&&r(s)}return function(...t){n?s=t:r(t)}}(t.win,this.gz.bind(this));this.Uu.onScroll(i.bind(this)),this.Uu.onResize(i.bind(this)),this.gz()}get mutator(){return this.oc}gz(){this.h0||(this.h0=!0,this.oc.measureElement((()=>{this.o0=this.Uu.getHeight();const t=this.Uu.getScrollTop(),i=t-this.Fx;if(Math.abs(i)<20)return;const e=i>0?-1:1;this.E_.forEach((t=>{t.usesSentinel()&&this.r0===e||this.updateRelativePos(t)})),this.Fx=t,this.r0=this.cz,this.cz=e})).then((()=>{this.h0=!1})))}isScrollingUp(){return 1===this.cz}isScrollingDown(){return-1===this.cz}observe(t,i,e){const n=new ct(this,e);this.E_.push(n),n.observe(t,i)}observeHost(t,i){const e=new lt(this,i,t);this.E_.push(e)}getPositionObserver(){return ut(this.Ni),(t=>V(this.Ni.getHeadNode(),"position-observer"))()}updateRelativePos(t){const i=t.usesSentinel()?this.getRelativePosFromSentinel(t):this.getRelativePosFromScroll(t);i&&t.callback(I(i))}getRelativePosFromScroll(t){const{Fx:i,o0:e}=this,{top:n}=t.nextPageEl.getLayoutBox();return i<n-e?5:i<n&&n<=e&&i<=0?1:i<n?this.isScrollingDown()?3:4:2}getRelativePosFromSentinel(t){const{bottom:i,top:e}=t,{BOTTOM:n,INSIDE:s,TOP:r}=ot;return e||i?e===s&&i===s?1:e&&e!==r||i&&i!==n?(e&&e!==r||i!==r)&&(e!==n||i&&i!==n)?!(e!==r&&e!==s||i&&i!==n)==!!this.isScrollingUp()?3:4:2:5:null}}(this.Ni),this.ri.then((()=>{this.WQ.observeHost(this.e0(),(t=>{this.KQ.relativePos=t,this.updateVisibility()}))})),this.YQ||(this.YQ=[this.KQ],this.setLastFetchedPage(this.KQ));const r=()=>{this.zQ(),this.ai()};return this.u0().then((()=>this.a0())).then(r,r),this.e0().classList.add("i-amphtml-next-page"),this.ri}u0(){return new Promise((t=>{if(0!=this.Uu.getScrollTop())return t();const i=this.Uu.onScroll((()=>{t(),i()}))}))}e0(){return this.qQ}maybeFetchNext(t=!1){const i=this.YQ.filter((t=>!t.is(1))).length>this.t0,e=this.YQ.some((t=>t.is(2))),n=this.c0()>3&&!t;if(this.HQ||e||n||i)return M();const s=this.YQ.length,r=this.YQ[this.l0(this.ZQ)+1];return r?r.fetch().then((()=>{r.is(4)&&this.setLastFetchedPage(r)})).then((()=>this.zQ()),(t=>this.zQ().then((()=>{throw t})))):this.p0().then((t=>this.f0(t))).then((()=>this.YQ.length<=s?(this.HQ=!0,this.zQ()):this.maybeFetchNext(!0)))}updateVisibility(){this.YQ.forEach(((t,i)=>{2===t.relativePos?t.isVisible()&&t.setVisibility(X):3!==t.relativePos&&(t.isVisible()||t.setVisibility(G),this.m0(i),this.d0(i))})),this.YQ.some((t=>t.isVisible()))||this.KQ.setVisibility(G),this.YQ.filter((t=>t.isVisible())).forEach((t=>this.toggleHiddenAndReplaceableElements(I(t.document))));const t=function(t,i){for(let i=0;i<t.length;i++)if(t[i].isVisible())return i;return-1}(this.YQ),i=this.YQ[t]||null;i&&this.QQ!==i&&this.setTitlePage(i),this.maybeFetchNext()}m0(t,i){const e=void 0===i?5:i;this.WQ.isScrollingDown()&&this.KQ.isVisible()&&this.KQ.setVisibility(X);const n=this.WQ.isScrollingDown()?this.YQ.slice(1,t).reverse():this.YQ.slice(t+1);return Promise.all(n.filter((t=>2===t.relativePos)).map(((t,i)=>{if(t.isVisible()&&t.setVisibility(X),i>=e)return t.pause()})))}d0(t,i){const e=void 0===i?5:i,n=this.YQ.slice(1).slice(Math.max(0,t-e-1),Math.min(this.YQ.length,t+e+1)).filter((t=>t.is(6)));return Promise.all(n.map((t=>t.resume())))}setLastFetchedPage(t){this.ZQ=t}setTitlePage(t=this.KQ){if(!t)return;const{title:i,url:e}=t;this.tp.title=i,this.vn.replace({title:i,url:e}),this.QQ=t,rt(this.e0(),"amp-next-page-scroll",{"title":i,"url":e},!1)}createHostPage(){const{location:t,title:i}=this.tp,{href:e}=t,n=function(t){const i=t.querySelector('script[type="application/ld+json"]');if(!i)return;const e=u(i.textContent);return e&&e.image?"string"==typeof e.image?e.image:e.image["@list"]&&"string"==typeof e.image["@list"][0]?e.image["@list"][0]:"string"==typeof e.image.url?e.image.url:"string"==typeof e.image[0]?e.image[0]:void 0:void 0}(this.tp)||function(t){const i=t.querySelector('meta[property="og:image"]');return i?i.getAttribute("content"):void 0}(this.tp)||function(t){const i=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return i?i.getAttribute("href"):void 0}(this.tp)||"";return new mt(this,{url:e,title:i||"",image:n},5,G,this.tp)}createDocumentContainerForPage(t){const i=this.tp.createElement("div");i.classList.add("i-amphtml-next-page-document-container"),this.qQ.insertBefore(i,this.BQ);const e=this.tp.createElement("div");return e.classList.add(Xt),i.appendChild(e),this.WQ.observe(e,i,(i=>{t.relativePos=i,this.updateVisibility()})),i}g0(){return this.Fe.hasCapability("cid")?"cid":null}attachDocumentToPage(t,i,e=!1){if(this.c0()<1&&!e)return Promise.resolve(null);const n=t.container;let s=f(n,`> .${l(Xt)}`);if(!s){I(t.is(6));const i=f(n,`> .${l(ti)}`);s=this.tp.createElement("div"),s.classList.add(Xt),n.replaceChild(s,i)}this.sanitizeDoc(i);try{const e=this.JQ.attachShadowDoc(s,i,t.url,{visibilityState:Q,cap:this.g0()}),r=this.Fe.maybeGetMessageDeliverer();r&&e.onMessage(((t,i,e)=>{if("documentHeight"!==t&&"scroll"!==t&&"viewport"!==t)return r(t,i,e)}));const o=I(e.ampdoc);Ct(o,wt,null,!1,Gt),o.getBody().classList.add("i-amphtml-next-page-document");const h=this.UQ.cloneNode(!0);return P(n,h),this.v0(h,t).then((()=>e))}catch(t){return y().error(Gt,"failed to attach shadow document for page",t),Promise.resolve(null)}}closeDocument(t){if(t.is(6))return M();const i=t.container,e=f(i,`> .${l(Xt)}`),n=this.tp.createElement("div");n.classList.add(ti);let s=0,r=0;return this.oc.measureMutateElement(e,(()=>{s=e.offsetHeight,r=e.offsetWidth}),(()=>{!function(t,i){for(const e in i)nt(t,e,i[e])}(n,{"height":`${s}px`,"width":`${r}px`}),i.replaceChild(n,e)}))}sanitizeDoc(t){i(t.querySelectorAll("amp-next-page")).forEach((t=>{if(this.XQ){const i=this.P0(t);this._0(i)}g(t)})),t.body.classList.add(pt),this.toggleHiddenAndReplaceableElements(t,!1)}toggleHiddenAndReplaceableElements(t,e=!0){t!==this.KQ.document&&i(t.querySelectorAll("[next-page-hide]")).forEach((t=>st(t,!1))),e&&i(t.querySelectorAll("*:not(amp-next-page) [next-page-replace]")).forEach((t=>{let i=t.getAttribute("next-page-replace");i||(i=String(Date.now()+Math.floor(100*Math.random())),t.setAttribute("next-page-replace",i)),this.GQ[i]&&this.GQ[i]!==t&&st(this.GQ[i],!1),this.GQ[i]=t,st(t,!0)}))}c0(){return Math.round((this.Uu.getScrollHeight()-this.Uu.getScrollTop()-this.Uu.getHeight())/this.Uu.getHeight())}l0(t){return this.YQ.indexOf(t)}fetchPageDocument(t){return K(this.i).fetch(t.url,{ampCors:!1}).then((i=>(xt(i.url,this.Ni.getUrl()),t.url=i.url,i.text()))).then((t=>{const i=this.tp.implementation.createHTMLDocument("");return i.open(),i.write(t),i.close(),i})).catch((i=>{throw R().error(Gt,"failed to fetch %s",t.url,i),i}))}a0(){const t=this.P0(this.e0());return t.length?this._0(t):(T(this.i0,"%s should contain a <script> child or a URL specified in [src]",Gt),this.p0().then((t=>0===t.length?M():this._0(t))))}f0(t){return!t.length||this.HQ||t.forEach((t=>{try{if(function(t,i){R().assertString(t.url,"page url must be a string");const e=_t(i),{origin:n}=Pt(i);var s,r;t.url=(s=t.url,r=vt(r=e),new URL(s,r.href).toString());const o=xt(t.url,i);R().assertString(t.image,"page image must be a string"),R().assertString(t.title,"page title must be a string");const h=bt(i);h!==n&&o.origin===h&&(t.url=`${n}/c/`+("https:"===o.protocol?"s/":"")+encodeURIComponent(o.host)+o.pathname+(o.search||"")+(o.hash||""))}(t,this.Ni.getUrl()),this.YQ.some((i=>i.initialUrl==t.url)))return;this.YQ.push(new ft(this,t))}catch(t){R().error(Gt,"Failed to queue page due to error:",t)}})),M()}_0(t){return this.f0(t).then((()=>this.maybeFetchNext()))}P0(t){const i=d(t,"SCRIPT");if(!i.length)return[];T(1===i.length,`${Gt} should contain at most one <script> child`);const e=i[0];T(function(t){var i;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(i=t.getAttribute("type"))||void 0===i?void 0:i.toUpperCase())}(e),`${Gt} page list should be inside a <script> tag with type="application/json"`);const n=u(e.textContent,(t=>{R().error(Gt,"failed to parse inline page list",t)})),s=R().assertArray(n,`${Gt} Page list expected an array, found: ${typeof n}`);return g(e),s}p0(){return this.i0?(this.FQ||(this.FQ=function(t,i,e={}){const{expr:n=".",urlReplacement:s=At.NONE,refresh:r=!1,xssiPrefix:h,url:u=i.getAttribute("src")}=e;!function(t,i,e="source"){var n;T(null!=t,"%s %s must be available",i,e),T("https:"==(n=vt(n=t)).protocol||"localhost"==n.hostname||"127.0.0.1"==n.hostname||function(t,i){const e=t.length-i.length;return e>=0&&t.indexOf(i,e)==e}(n.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',i,e,t)}(u,i);const a=S(t.win,"batched-xhr");return function(t,i,e,n){const s=(t=>k(t,"url-replace"))(t);return(e>=At.OPT_IN?s.expandUrlAsync(i):Promise.resolve(i)).then((i=>{if(e===At.OPT_IN){const i=s.collectDisallowedVarsSync(t);if(i.length>0)throw R().createError(`URL variable substitutions in CORS fetches from dynamic URLs (e.g. via amp-bind) require opt-in. Please add data-amp-replace="${i.join(" ")}" to the <${t.tagName}> element. See https://bit.ly/amp-var-subs.`)}const r={};return t.hasAttribute("credentials")&&(r.credentials=t.getAttribute("credentials")),n&&(r.cache="reload"),{"xhrUrl":i,"fetchOpt":r}}))}(i,u,s,r).then((t=>a.fetchJson(t.xhrUrl,t.fetchOpt))).then((i=>K(t.win).xssiJson(i,h))).then((t=>{if(null==t)throw new Error("Response is undefined.");return function(t,i){if("."==i)return t;const e=i.split(".");let n=t;for(const t of e){if(!(t&&n&&void 0!==n[t]&&"object"==typeof n&&o(n,t))){n=void 0;break}n=n[t]}return n}(t,n||".")})).catch((t=>{throw R().createError("failed fetching JSON data",t)}))}(this.Ni,this.e0(),{urlReplacement:At.ALL,xssiPrefix:this.e0().getAttribute("xssi-prefix")||void 0}).then((t=>(this.i0=t.next||null,this.i0&&this.e0().setAttribute("src",this.i0),t.pages||[]))).catch((t=>(R().error(Gt,"error fetching page list from remote server",t),this.i0=null,[])))),this.FQ):Promise.resolve([])}n0(t){const i=m(t,"separator");return i?(g(i),i.hasAttribute("tabindex")||i.setAttribute("tabindex","0"),i):this.b0()}b0(){return tt(this.e0())(Zt)}v0(t,i){if(!this.tM.hasTemplate(t))return M();const e={title:i.title,url:i.url,image:i.image};return this.tM.findAndRenderTemplate(t,e).then((i=>this.oc.mutateElement(t,(()=>{v(t),t.appendChild(i)}))))}s0(t){const i=m(t,"recommendation-box");return i?(this.zQ=this.tM.hasTemplate(i)?()=>this.x0():ii,i):(this.zQ=()=>this.w0(),this.A0())}A0(){return tt(this.e0())(Kt)}x0(){const t=this.BQ;I(this.tM.hasTemplate(t));const i=this.tM.maybeFindTemplate(t),e={pages:(this.YQ||[]).filter((t=>!t.isLoaded()&&!t.is(2))).map((t=>({title:t.title,url:t.url,image:t.image})))};return this.tM.findAndRenderTemplate(t,e).then((e=>this.oc.mutateElement(t,(()=>{v(t),t.appendChild(i),t.appendChild(e)}))))}w0(){const t=this.BQ,i={pages:(this.YQ||[]).filter((t=>!t.isLoaded()&&!t.is(2))).map((t=>({title:t.title,url:t.url,image:t.image})))},e=tt(this.e0()),n=i.pages.map((t=>{const i=e(Qt),{image:n,title:s}=function(t){const i=t.querySelectorAll("[ref]"),e=r();for(let t=0;t<i.length;t++){const n=i[t],s=n.getAttribute("ref");h(s),n.removeAttribute("ref"),h(void 0===e[s]),e[s]=n}return e}(i);return n.src=t.image,s.textContent=t.title,i.href=t.url,i.addEventListener("click",(i=>{rt(this.e0(),"amp-next-page-click",{"title":t.title,"url":t.url},!1),this.UR.navigateToAmpUrl(t.url,"content-discovery")&&i.preventDefault()})),i}));return this.oc.mutateElement(t,(()=>{v(t),n.forEach((i=>t.appendChild(i)))}))}}),t.registerElement("amp-next-page",ei,wt)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
/**
* @license
* Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
* Use of this source code is governed by a BSD-style
* license that can be found in the LICENSE file or at
* https://developers.google.com/open-source/licenses/bsd
*/}});
//# sourceMappingURL=amp-next-page-1.0.mjs.map