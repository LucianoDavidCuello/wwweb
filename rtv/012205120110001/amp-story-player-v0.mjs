;
(()=>{var{isArray:t}=Array;function i(t,i){const s=[];let e=0;for(let n=0;n<t.length;n++){const r=t[n];i(r,n,t)?s.push(r):(e<n&&(t[e]=r),e++)}return e<t.length&&(t.length=e),s}function s(t,i){for(let s=0;s<t.length;s++)if(i(t[s],s,t))return s;return-1}function e(t){return"string"==typeof t}var{hasOwnProperty:n,toString:r}=Object.prototype;function o(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function a(t){return 1==(null==t?void 0:t.nodeType)}var h="​​​";function l(t){return a(t)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t}function c(t,s,e="Assertion failed",n){var r,o;if(s)return s;t&&-1==e.indexOf(t)&&(e+=t);let a=3;const h=e.split("%s");let c=h.shift();const u=[c];for(;h.length;){const t=arguments[a++],i=h.shift();c+=l(t)+i,u.push(t,i.trim())}const f=new Error(c);throw f.messageArray=i(u,(t=>""!==t)),null===(r=(o=self).__AMP_REPORT_ERROR)||void 0===r||r.call(o,f),f}function u(i,s,e,n,r){return t(r)?i(e,r.concat([s])):i(e,`${r||n}: %s`,s),s}function f(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:e}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=e,n}function p(t){let i=null,s="";for(const t of arguments)t instanceof Error&&!i?i=f(t):(s&&(s+=" "),s+=t);return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function m(t){const i=p.apply(null,arguments);return i.expected=!0,i}function d(t,i,s){let e=0,n=null;function r(r){n=null,e=t.setTimeout(o,s),i.apply(null,r)}function o(){e=0,n&&r(n)}return function(...t){e?n=t:r(t)}}var y=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function _(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function g(t){const i=o();if(!t)return i;let s;for(;s=y.exec(t);){const t=_(s[1],s[1]),e=s[2]?_(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}var v=t=>self.AMP_CONFIG?self.AMP_CONFIG[t]:null,P=("string"==typeof v("cdnProxyRegex")?new RegExp(v("cdnProxyRegex")):v("cdnProxyRegex"))||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function A(t){if(!self.document||!self.document.head)return null;if(self.location&&P.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}var b=v("cdnUrl")||A("runtime-host")||"https://cdn.ampproject.org",w=()=>{},E=(t,i)=>i.reduce(((t,i)=>`${t}&s[]=${M(i)}`),`https://log.amp.dev/?v=012205120110001&id=${encodeURIComponent(t)}`),M=t=>encodeURIComponent(String(l(t))),T=t=>parseInt(function(t){const{location:i}=t||self;return g(i.originalHash||i.hash)}(t).log,10);self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var x=self.__AMP_LOG,R=null;function I(){R=class{constructor(t,i,s=""){this.win=t,this.J=i,this.W=this.X(),this.B=s,this.Z=null,this.K=function(t){let i=!1,s=null,e=t;return(...t)=>(i||(s=e.apply(self,t),i=!0,e=null),s)}((()=>{t.fetch(`${b}/rtv/012205120110001/log-messages.simple.json`).then((t=>t.json()),w).then((t=>{t&&(this.Z=t)}))})),this.Y=this.assert.bind(this)}X(){var t;const{win:i}=this;return null!==(t=i.console)&&void 0!==t&&t.log&&0!=T(i)?this.tt():0}tt(t){return this.J(T(t),!1)}et(t,i,s){var n;if(i>this.W)return!1;const r=this.win.console,o=null!==(n={1:r.error,3:r.info,2:r.warn}[i])&&void 0!==n?n:r.log,a=this.nt(s),h=`[${t}]`;return e(a[0])?a[0]=h+" "+a[0]:a.unshift(h),o.apply(r,a),!0}fine(t,...i){this.et(t,4,i)}info(t,...i){this.et(t,3,i)}warn(t,...i){this.et(t,2,i)}error(t,...i){if(!this.et(t,1,i)){var s,e;const n=this.createError.apply(this,i);n.name=t||n.name,null===(s=(e=self).__AMP_REPORT_ERROR)||void 0===s||s.call(e,n)}}expectedError(t,...i){var s,e;this.et(t,1,i)||null===(s=(e=self).__AMP_REPORT_ERROR)||void 0===s||s.call(e,this.createExpectedError.apply(this,i))}createError(t){return this.ot(p.apply(null,arguments))}createExpectedError(t){return this.ot(m.apply(null,arguments))}ot(t){return t=f(t),this.B?t.message?-1==t.message.indexOf(this.B)&&(t.message+=this.B):t.message=this.B:t.message.indexOf(h)>=0&&(t.message=t.message.replace(h,"")),t}nt(i){return t(i[0])?this.rt(i[0]):i}rt(t){var i;const s=t.shift();return null!==(i=this.Z)&&void 0!==i&&i[s]?[this.Z[s]].concat(t):[`More info at ${E(s,t)}`]}assert(i,s,e){return t(s)?this.assert.apply(this,[i].concat(this.rt(s))):c.apply(null,[this.B].concat(Array.prototype.slice.call(arguments)))}assertElement(t,i){return function(t,i,s){return u(t,i,a(i),"Element expected",s)}(this.Y,t,i)}assertString(t,i){return function(t,i,s){return u(t,i,e(i),"String expected",s)}(this.Y,t,i)}assertNumber(t,i){return function(t,i,s){return u(t,i,"number"==typeof i,"Number expected",s)}(this.Y,t,i)}assertArray(i,s){return function(i,s,e){return u(i,s,t(s),"Array expected",e)}(this.Y,i,s)}assertBoolean(t,i){return function(t,i,s){return u(t,i,!!i===i,"Boolean expected",s)}(this.Y,t,i)}},x.dev||(x.dev=V((t=>t>=3?4:t>=2?3:0))),function(t){if(x.user||(x.user=S(h)),void x.user.win)return x.userForEmbed||(x.userForEmbed=S("​​​​"));x.user}()}function V(t,i){if(!R)throw new Error("failed to call initLogConstructor");return new R(self,t,i)}function S(t){return V(((t,i)=>i||t>=1?4:2),t)}var k,j=class{constructor(t,i){this.i=t,this._f=i,this.tp=this.i.document,this.ip=!1,this.sp=!1,this.ep=null}buildCallback(){this.ip||(this.np(),this.ip=!0)}layoutCallback(){this.sp||(this.sp=!0)}np(){this.ep=this.tp.createElement("main");const t=this._f.attachShadow({mode:"open"}),i=this.tp.createElement("style");i.textContent="amp-story-entry-point{position:relative;display:block}\n/*# sourceURL=/css/amp-story-entry-point.css*/",t.appendChild(i),t.appendChild(this.ep)}getElement(){return this._f}};function z(){return k||(k=Promise.resolve(void 0))}var O=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}};function $(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function F(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function q(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?F(Object(s),!0).forEach((function(i){$(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var U="ase art bmp blp cd5 cit cpt cr2 cut dds dib djvu egt exif gif gpl grf icns ico iff jng jpeg jpg jfif jp2 jps lbm max miff mng msp nitf ota pbm pc1 pc2 pc3 pcf pcx pdn pgm PI1 PI2 PI3 pict pct pnm pns ppm psb psd pdd psp px pxm pxr qfx raw rle sct sgi rgb int bw tga tiff tif vtf xbm xcf xpm 3dv amf ai awg cgm cdr cmx dxf e2d egt eps fs gbr odg svg stl vrml x3d sxd v2d vnd wmf emf art xar png webp jxr hdp wdp cur ecw iff lbm liff nrrd pam pcx pgf sgi rgb rgba bw int inta sid ras sun tga".split(" "),C="### #gf $on $tf 0b 8m 8u 12u 15u 64c 075 75 085 85 91 091 096 96 abf acfm acs afm afn afs all amfm apf asf aspf atm auf b30 bco bdf bepf bez bfn bmap bmf bx bzr cbtf cct cef cff cfn cga ch4 cha chm chr chx claf collection compositefont dfont dus dzk eft eot etx euf f00 f06 f08 f09 f3f f10 f11 f12 f13 f16 fd fdb ff ffil flf fli fn3 fnb fnn fnt fnta fo1 fo2 fog fon font fonts fot frf frs ftm fxr fyi gdr gf gft glf glif glyphs gsf gxf hbf ice intellifont lepf lft lwfn mcf mcf mfd mfm mft mgf mmm mrf mtf mvec nlq ntf odttf ofm okf otf pcf pcf pfa pfb pfm pft phf pk pkt prs pss qbf qfn r8? scr sfd sff sfi sfl sfn sfo sfp sfs sif snf spd spritefont sui suit svg sxs t1c t2 tb1 tb2 tdf tfm tmf tpf ttc tte ttf type ufm ufo usl usp us? vf vf1 vf3 vfb vfm vfont vlw vmf vnf w30 wfn wnf woff woff2 xfc xfn xfr xft zfi zsu _v".split(" "),D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function N(t,i){if(i=i.split(":")[0],!(t=+t))return!1;switch(i){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}var L=Object.prototype.hasOwnProperty;function Y(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}var H={stringify:function(t,i){i=i||"";var s,e=[];for(n in"string"!=typeof i&&(i="?"),t)if(L.call(t,n)){(s=t[n])||null!=s&&!isNaN(s)||(s="");var n=encodeURIComponent(n);s=encodeURIComponent(s),null!==n&&null!==s&&e.push(n+"="+s)}return e.length?i+e.join("&"):""},parse:function(t){for(var i,s=/([^=?&]+)=?([^&]*)/g,e={};i=s.exec(t);){var n=Y(i[1]);i=Y(i[2]),null===n||null===i||n in e||(e[n]=i)}return e}},X=/^[A-Za-z][A-Za-z0-9+-.]*:[\\/]+/,B=/^([a-z][a-z0-9.+-]*:)?([\\/]{1,})?([\S\s]*)/i,Z=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/;function G(t){return(t||"").toString().replace(Z,"")}var J=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],W={hash:1,query:1};function Q(t){var i=("undefined"!=typeof window?window:void 0!==D?D:"undefined"!=typeof self?self:{}).location||{};t=t||i,i={};var s,e=typeof t;if("blob:"===t.protocol)i=new tt(unescape(t.pathname),{});else if("string"===e)for(s in i=new tt(t,{}),W)delete i[s];else if("object"===e){for(s in t)s in W||(i[s]=t[s]);void 0===i.slashes&&(i.slashes=X.test(t.href))}return i}function K(t){return t=G(t),{protocol:(t=B.exec(t))[1]?t[1].toLowerCase():"",slashes:!!(t[2]&&2<=t[2].length),rest:t[2]&&1===t[2].length?"/"+t[3]:t[3]}}function tt(t,i,s){if(t=G(t),!(this instanceof tt))return new tt(t,i,s);var e=J.slice(),n=typeof i,r=0;"object"!==n&&"string"!==n&&(s=i,i=null),s&&"function"!=typeof s&&(s=H.parse),i=Q(i);var o=K(t||"");for(n=!o.protocol&&!o.slashes,this.slashes=o.slashes||n&&i.slashes,this.protocol=o.protocol||i.protocol||"",t=o.rest,o.slashes||(e[3]=[/(.*)/,"pathname"]);r<e.length;r++)if("function"==typeof(o=e[r]))t=o(t);else{var a=o[0],h=o[1];a!=a?this[h]=t:"string"==typeof a?~(a=t.indexOf(a))&&("number"==typeof o[2]?(this[h]=t.slice(0,a),t=t.slice(a+o[2])):(this[h]=t.slice(a),t=t.slice(0,a))):(a=a.exec(t))&&(this[h]=a[1],t=t.slice(0,a.index)),this[h]=this[h]||n&&o[3]&&i[h]||"",o[4]&&(this[h]=this[h].toLowerCase())}if(s&&(this.query=s(this.query)),n&&i.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==i.pathname)){if(t=this.pathname,i=i.pathname,""!==t){for(s=(i=(i||"/").split("/").slice(0,-1).concat(t.split("/")))[(t=i.length)-1],e=!1,r=0;t--;)"."===i[t]?i.splice(t,1):".."===i[t]?(i.splice(t,1),r++):r&&(0===t&&(e=!0),i.splice(t,1),r--);e&&i.unshift(""),"."!==s&&".."!==s||i.push(""),i=i.join("/")}this.pathname=i}"/"!==this.pathname.charAt(0)&&this.hostname&&(this.pathname="/"+this.pathname),N(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(o=this.auth.split(":"),this.username=o[0]||"",this.password=o[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}tt.prototype={set:function(t,i,s){switch(t){case"query":"string"==typeof i&&i.length&&(i=(s||H.parse)(i)),this[t]=i;break;case"port":this[t]=i,N(i,this.protocol)?i&&(this.host=this.hostname+":"+i):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=i,this.port&&(i+=":"+this.port),this.host=i;break;case"host":this[t]=i,/:\d+$/.test(i)?(i=i.split(":"),this.port=i.pop(),this.hostname=i.join(":")):(this.hostname=i,this.port="");break;case"protocol":this.protocol=i.toLowerCase(),this.slashes=!s;break;case"pathname":case"hash":i?(s="pathname"===t?"/":"#",this[t]=i.charAt(0)!==s?s+i:i):this[t]=i;break;default:this[t]=i}for(t=0;t<J.length;t++)(i=J[t])[4]&&(this[i[1]]=this[i[1]].toLowerCase());return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=H.stringify);var i=this.protocol;return i&&":"!==i.charAt(i.length-1)&&(i+=":"),i+=this.slashes?"//":"",this.username&&(i+=this.username,this.password&&(i+=":"+this.password),i+="@"),i+=this.host+this.pathname,(t="object"==typeof this.query?t(this.query):this.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(i+=this.hash),i}},tt.extractProtocol=K,tt.location=Q,tt.trimLeft=G,tt.qs=H;var it=tt,st=/^xn--/,et=/[^\0-\x7E]/,nt=/[\x2E\u3002\uFF0E\uFF61]/g,rt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ot=Math.floor,at=String.fromCharCode;function ht(t){throw new RangeError(rt[t])}function lt(t,i){var s=t.split("@");let e="";1<s.length&&(e=s[0]+"@",t=s[1]);{s=[];let e=(t=(t=t.replace(nt,".")).split(".")).length;for(;e--;)s[e]=i(t[e]);i=s}return e+i.join(".")}function ct(t,i){return t+22+75*(26>t)-((0!=i)<<5)}function ut(t,i,s){let e=0;for(t=s?ot(t/700):t>>1,t+=ot(t/i);455<t;e+=36)t=ot(t/35);return ot(e+36*t/(t+38))}var ft=function(t){return lt(t,(function(t){return st.test(t)?function(t){const i=[],s=t.length;let e=0,n=128,r=72;var o=t.lastIndexOf("-");0>o&&(o=0);for(var a=0;a<o;++a)128<=t.charCodeAt(a)&&ht("not-basic"),i.push(t.charCodeAt(a));for(o=0<o?o+1:0;o<s;){a=e;for(let i=1,n=36;;n+=36){o>=s&&ht("invalid-input");var h=t.charCodeAt(o++);(36<=(h=10>h-48?h-22:26>h-65?h-65:26>h-97?h-97:36)||h>ot((2147483647-e)/i))&&ht("overflow"),e+=h*i;const a=n<=r?1:n>=r+26?26:n-r;if(h<a)break;i>ot(2147483647/(h=36-a))&&ht("overflow"),i*=h}r=ut(e-a,h=i.length+1,0==a),ot(e/h)>2147483647-n&&ht("overflow"),n+=ot(e/h),e%=h,i.splice(e++,0,n)}return String.fromCodePoint(...i)}(t.slice(4).toLowerCase()):t}))},pt=/[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,mt=/[\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc]/;function dt(t){return(t="undefined"!=typeof window?function(t){return t=new TextEncoder("utf-8").encode(t),window.crypto.subtle.digest("SHA-256",t).then((t=>{var i=[];t=new DataView(t);for(let s=0;s<t.byteLength;s+=4){let e=("00000000"+t.getUint32(s).toString(16)).slice(-8);i.push(e)}return i.join("")}))}(t):void 0).then((t=>function(t){let i=[];t.match(/.{1,2}/g).forEach(((t,s)=>{i[s]=parseInt(t,16)}));var s=i.length%5,e=Math.floor(i.length/5);if(t=[],0!=s){for(var n=0;n<5-s;n++)i+="\0";e+=1}for(n=0;n<e;n++)t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(i[5*n]>>3)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((7&i[5*n])<<2|i[5*n+1]>>6)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((63&i[5*n+1])>>1)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((1&i[5*n+1])<<4|i[5*n+2]>>4)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((15&i[5*n+2])<<1|i[5*n+3]>>7)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((127&i[5*n+3])>>2)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((3&i[5*n+3])<<3|i[5*n+4]>>5)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(31&i[5*n+4]));for(e=0,1==s?e=6:2==s?e=4:3==s?e=3:4==s&&(e=1),s=0;s<e;s++)t.pop();for(s=0;s<e;s++)t.push("=");return t.join("")}("ffffffffff"+t+"000000").substr(8,Math.ceil(4*t.length/5))))}function yt(t){return"--"==t.slice(2,4)&&"xn"!=t.slice(0,2)}function _t(t,i,s=null){let e=new it(i),n=function(t,i=null){return(t=>U.some((i=>!!t.endsWith(`.${i}`))))(t)?"/i":(t=>C.some((i=>!!t.endsWith(`.${i}`))))(t)?"/r":"viewer"===i?"/v":"/c"}(e.pathname,s);return n+="https:"===e.protocol?"/s/":"/",i.endsWith("/")||(e.pathname=e.pathname.replace(/\/$/,"")),function(t){if(yt(t=new it(t).hostname))var i=!1;else i=ft(t),i=63>=t.length&&!(pt.test(i)&&mt.test(i))&&-1!=t.indexOf(".");return i?63<(i=function(t){return lt(t,(function(t){return et.test(t)?"xn--"+function(t){const i=[];let s=(t=function(t){let i=[],s=0,e=t.length;for(;s<e;){let n=t.charCodeAt(s++);if(55296<=n&&56319>=n&&s<e){let e=t.charCodeAt(s++);56320==(64512&e)?i.push(((1023&n)<<10)+(1023&e)+65536):(i.push(n),s--)}else i.push(n)}return i}(t)).length,e=128,n=0,r=72;for(var o of t)128>o&&i.push(at(o));let a=o=i.length;for(o&&i.push("-");a<s;){var h=2147483647;for(const i of t)i>=e&&i<h&&(h=i);const s=a+1;h-e>ot((2147483647-n)/s)&&ht("overflow"),n+=(h-e)*s,e=h;for(const c of t)if(c<e&&2147483647<++n&&ht("overflow"),c==e){var l=n;for(h=36;;h+=36){const t=h<=r?1:h>=r+26?26:h-r;if(l<t)break;l-=t;const s=36-t;i.push(at(ct(t+l%s,0))),l=ot(l/s)}i.push(at(ct(l,0))),r=ut(n,s,a==o),n=0,++a}++n,++e}return i.join("")}(t):t}))}(i=(i=(i=ft(t)).split("-").join("--")).split(".").join("-")).toLowerCase()).length?dt(t):(yt(i)&&(i="0-".concat(i,"-0")),Promise.resolve(i)):dt(t)}(e.toString()).then((s=>{let r=new it(i);return r.protocol="https",s=s+"."+t,r.host=s,r.hostname=s,r.pathname=n+e.hostname+e.pathname,r.toString()}))}var gt="amp-viewer-messaging",vt="channelOpen",Pt="__AMPHTML__";function At(t){if("string"!=typeof t)return t;if("{"!=t.charAt(0))return null;try{return JSON.parse(t)}catch(t){return null}}var bt=class{static initiateHandshakeWithDocument(t,i){return new Promise((s=>{const e=setInterval((()=>{const n=new MessageChannel,r={app:Pt,name:"handshake-poll"};t.postMessage(r,"*",[n.port2]);const o=n.port1,a=t=>{const n=At(t.data);if(n&&n.app===Pt&&n.name===vt){clearInterval(e),o.removeEventListener("message",a);const t=new bt(null,o,!1,i,!0);t.sendResponse_(n.requestid,vt,null),s(t)}};o.addEventListener("message",a),o.start()}),1e3)}))}static waitForHandshakeFromDocument(t,i,s,e,n){return new Promise((r=>{const o=a=>{const h=At(a.data);if(h&&(a.origin==s||n&&n.test(a.origin))&&(!a.source||a.source==i)&&h.app===Pt&&h.name===vt){t.removeEventListener("message",o);const s=new class{constructor(t,i,s){this.win_=t,this.origin_=i,this.target_=s}addEventListener(t,i){this.win_.addEventListener("message",(t=>{t.origin==this.origin_&&t.source==this.target_&&i(t)}))}postMessage(t){const i="null"===this.origin_?"*":this.origin_;this.target_.postMessage(t,i)}start(){}}(t,a.origin,i),n=new bt(null,s,!1,e,!0);n.sendResponse_(h.requestid,vt,null),r(n)}};t.addEventListener("message",o)}))}constructor(t,i,s,e,n){this.win_=t,this.port_=i,this.isWebview_=!!s,this.token_=e||null,this.verifyToken_=!!n,this.requestIdCounter_=0,this.waitingForResponse_={},this.messageHandlers_={},this.defaultHandler_=null,this.port_.addEventListener("message",this.handleMessage_.bind(this)),this.port_.start()}registerHandler(t,i){this.messageHandlers_[t]=i}unregisterHandler(t){delete this.messageHandlers_[t]}setDefaultHandler(t){this.defaultHandler_=t}handleMessage_(t){const i=At(t.data);i&&i.app===Pt&&(this.token_&&this.verifyToken_&&i.messagingToken!==this.token_?this.logError_(gt+": handleMessage_ error: ","invalid token"):"q"===i.type?this.handleRequest_(i):"s"===i.type&&this.handleResponse_(i))}sendRequest(t,i,s){const e=++this.requestIdCounter_;let n;return s&&(n=new Promise(((t,i)=>{this.waitingForResponse_[e]={resolve:t,reject:i}}))),this.sendMessage_({app:Pt,requestid:e,type:"q",name:t,data:i,rsvp:s}),n}sendResponse_(t,i,s){this.sendMessage_({app:Pt,requestid:t,type:"s",name:i,data:s})}sendResponseError_(t,i,s){const e=this.errorToString_(s);this.logError_(gt+": sendResponseError_, message name: "+i,e),this.sendMessage_({app:Pt,requestid:t,type:"s",name:i,data:null,error:e})}sendMessage_(t){const i=Object.assign(t,{});this.token_&&!this.verifyToken_&&(i.messagingToken=this.token_),this.port_.postMessage(this.isWebview_?JSON.stringify(i):i)}handleRequest_(t){let i=this.messageHandlers_[t.name];if(i||(i=this.defaultHandler_),!i){const i=new Error("Cannot handle request because no default handler is set!");throw i.args=t.name,i}const s=i(t.name,t.data,!!t.rsvp);if(t.rsvp){const i=t.requestid;if(!s)throw this.sendResponseError_(i,t.name,new Error("no response")),new Error("expected response but none given: "+t.name);s.then((s=>{this.sendResponse_(i,t.name,s)}),(s=>{this.sendResponseError_(i,t.name,s)}))}}handleResponse_(t){const i=t.requestid,s=this.waitingForResponse_[i];s&&(delete this.waitingForResponse_[i],t.error?(this.logError_(gt+": handleResponse_ error: ",t.error),s.reject(new Error(`Request ${t.name} failed: ${t.error}`))):s.resolve(t.data))}logError_(t,i){if(!this.win_)return;let s="amp-messaging-error-logger: "+t;s+=" data: "+this.errorToString_(i),this.win_.viewerState=s}errorToString_(t){return t?t.message?t.message:String(t):"unknown error"}};function wt(t,i){return t}var Et,Mt="visible";function Tt(t){try{t.focus()}catch(t){}}function xt(t,i,s){const e=t.hasAttribute(i),n=void 0!==s?s:!e;return n!==e&&(n?t.setAttribute(i,""):t.removeAttribute(i)),n}var Rt,It=["Webkit","webkit","Moz","moz","ms","O","o"];function Vt(t,i,s,e,n){const r=function(t,i,s){if(i.startsWith("--"))return i;Et||(Et=o());let e=Et[i];if(!e||s){if(e=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<It.length;s++){const e=It[s]+i;if(void 0!==t[e])return e}return""}(t,s);void 0!==t[n]&&(e=n)}s||(Et[i]=e)}return e}(t.style,i,n);if(!r)return;const a=e?s+e:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return It.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(r),a)}function St(t,i){for(const s in i)Vt(t,s,i[s])}function kt(t,i){for(let s=0;s<i.length;s++)Vt(t,i[s],null)}function jt(t,i,s,e){const n={detail:s};return Object.assign(n,e),new t.CustomEvent(i,n)}var zt,Ot=class{constructor(t,i,s){this.i=t,this._f=i,this.rp=s,this.op=null,this.ap()}ap(){this.i.IntersectionObserver&&this.i===this.i.parent?this.hp():this.lp()}hp(){const t=new this.i.IntersectionObserver((i=>{i.forEach((i=>{i.isIntersecting&&(this.rp(),t.unobserve(this._f))}))}));t.observe(this._f)}lp(){this.op=d(this.i,this.cp.bind(this),500),this.i.addEventListener("scroll",this.op),this.cp(this._f)}cp(){const t=this._f.getBoundingClientRect().top;this.i.innerHeight>t&&(this.rp(),this.i.removeEventListener("scroll",this.op))}};function $t(t,i){return zt||(zt=self.document.createElement("a")),Ft(zt,t)}function Ft(t,i,s){return t.href="",new URL(i,t.href)}function qt(i){const s=[];for(const o in i){let a=i[o];if(null!=a){a=t(r=a)?r:[r];for(let t=0;t<a.length;t++)s.push((e=o,n=a[t],`${encodeURIComponent(e)}=${encodeURIComponent(n)}`))}}var e,n,r;return s.join("&")}function Ut(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}function Ct(t){const i=t.indexOf("#");return-1==i?"":t.substring(i)}function Dt(t){return P.test((t=>"string"==typeof t?$t(t):t)(t).origin)}function Nt(t){const i=t.indexOf("?");if(-1==i)return t;const s=Ct(t);return t.substring(0,i)+s}new Set(["c","v","a","ad"]);var Lt="i-amphtml-story-player-loading",Yt="i-amphtml-story-player-loaded",Ht="i-amphtml-story-player-error",Xt=["cdn.ampproject.org","www.bing-amp.com"],Bt=["allow-top-navigation"],Zt="amp-story-player-hide-button",Gt="PAGE_ATTACHMENT_STATE",Jt="UI_STATE",Wt="MUTED_STATE",Qt="CURRENT_PAGE_ID",Kt="i-amphtml-story-player-no-navigation-transition",ti="amp-story-player",ii=class{constructor(t,i){return this.i=t,this._f=i,this.tp=t.document,this.up=this.tp.createElement("a"),this.fp=[],this.ep=null,this.pp=0,this.mp=0,this.dp=null,this.yp=null,this._p=null,this.gp={startX:0,startY:0,lastX:0,isSwipeX:null},this.vp=null,this.Pp=new O,this.Ap(),this.bp=new class{constructor(t){this.i=t,this.gp={startY:0,lastDelta:0,touchStartTimeMs:null,touchEndTimeMs:null,touchMoveTimeMs:null},this.wp={startY:0,isRunning:!1,acceleration:1,speedLimit:.3,startTimeMs:null,maxTimeBetweenSwipesMs:250,moveTimeThresholdMs:100,durationMs:null,meetsDeltaYThreshold:!1,deltaYThresholdPx:5,deltaY:null,offsetThresholdPx:30,offsetPx:null,multiplier:1}}onTouchStart(t,i){this.gp.startY=i,this.gp.touchStartTimeMs=t,this.wp.startY=this.i.scrollY,this.wp.isRunning&&this.gp.touchEndTimeMs-this.gp.touchStartTimeMs<this.wp.maxTimeBetweenSwipesMs?this.wp.multiplier+=this.wp.acceleration:this.wp.multiplier=1,this.wp.isRunning=!1}onTouchMove(t,i){this.wp.acceleration=Math.abs(this.wp.deltaY/(t-this.gp.touchMoveTimeMs)),this.gp.touchMoveTimeMs=t,d(this.i,this.Ep.bind(this,i),50)()}Ep(t){this.wp.deltaY=t-this.gp.startY,this.wp.meetsDeltaYThreshold=Math.abs(this.wp.deltaY)>this.wp.deltaYThresholdPx,this.wp.meetsDeltaYThreshold&&this.i.scrollBy(0,-this.wp.deltaY)}onTouchEnd(t){if(this.gp.touchEndTimeMs=t,!this.wp.meetsDeltaYThreshold)return;const i=this.gp.touchEndTimeMs-this.gp.touchMoveTimeMs;this.wp.offsetPx=this.Mp(),i<this.wp.moveTimeThresholdMs&&Math.abs(this.wp.offsetPx)>this.wp.offsetThresholdPx&&(this.wp.durationMs=1.2*this.i.innerHeight,this.wp.isRunning=!0,requestAnimationFrame((t=>{this.wp.startTimeMs=t,this.wp.startY=this.i.scrollY,this.Tp(t)}))),this.wp.multiplier=1,this.gp.startY=0,this.wp.deltaY=0}Mp(){const t=this.i.innerHeight*this.wp.speedLimit;let i=Math.pow(this.wp.acceleration,2)*this.i.innerHeight;return i=Math.min(t,i),i*=this.wp.deltaY>0?-this.wp.multiplier:this.wp.multiplier,i}Tp(t){const i=t-this.wp.startTimeMs;if(i>this.wp.durationMs)return;const s=this.xp(i/this.wp.durationMs)*this.wp.offsetPx,e=this.wp.startY+s;this.wp.isRunning?(this.i.scroll(0,e),requestAnimationFrame(this.Tp.bind(this))):cancelAnimationFrame(requestAnimationFrame(this.Tp.bind(this)))}xp(t){return 1- --t*t*t*t}}(t),this.Rp=!0,this.Ip=null,this.Vp=null,this.Sp=null,this._f}Ap(){this._f.buildPlayer=this.buildPlayer.bind(this),this._f.layoutPlayer=this.layoutPlayer.bind(this),this._f.getElement=this.getElement.bind(this),this._f.getStories=this.getStories.bind(this),this._f.load=this.load.bind(this),this._f.show=this.show.bind(this),this._f.add=this.add.bind(this),this._f.play=this.play.bind(this),this._f.pause=this.pause.bind(this),this._f.go=this.go.bind(this),this._f.mute=this.mute.bind(this),this._f.unmute=this.unmute.bind(this),this._f.getStoryState=this.getStoryState.bind(this),this._f.rewind=this.rewind.bind(this)}load(){if(!this._f.isConnected)throw new Error(`[${ti}] element must be connected to the DOM before calling load().`);if(this._f.ip)throw new Error(`[${ti}] calling load() on an already loaded element.`);this.buildPlayer(),this.layoutPlayer()}kp(t){t.idx=this.fp.length,t.distance=t.idx-this.pp,t.connectedDeferred=new O,this.fp.push(t)}add(t){if(t.length<=0)return;if(!Array.isArray(t)||!t.every((t=>t&&t.href)))throw new Error('"stories" parameter has the wrong structure');const i=this.fp.length;for(let i=0;i<t.length;i++){const s=t[i];this.kp(s),this.jp(s)}this.mo(i)}play(){this._f.sp||this.layoutPlayer(),this.zp(!1)}pause(){this.zp(!0)}zp(t){this.Rp=!t;const i=this.fp[this.pp];this.ei(i,t?"paused":Mt)}getElement(){return this._f}getStories(){return this.fp}buildPlayer(){this._f.ip||(this.Op(),this.np(),this.$p(),this.Fp(),this.qp(),this.Up(this.fp.length-this.pp-1),this.Cp(),this.Dp(),this.Np(),this.Lp(),this.Yp(),this.Hp(),this._f.ip=!0)}Op(){var t;((t=this._f.querySelectorAll("a"))?Array.prototype.slice.call(t):[]).forEach((t=>{const i=t.querySelector("img[data-amp-story-player-poster-img]"),s=i&&i.getAttribute("src"),e={href:t.href,title:t.textContent&&t.textContent.trim()||null,posterImage:t.getAttribute("data-poster-portrait-src")||s};this.kp(e)}))}Hp(){this._f.dispatchEvent(jt(this.i,"ready",{})),this._f.isReady=!0}$p(){this.fp.forEach((t=>{this.jp(t)}))}np(){this.ep=this.tp.createElement("div"),this.ep.classList.add("i-amphtml-story-player-main-container");const t=this.tp.createElement("div");t.classList.add("i-amphtml-fill-content","i-amphtml-story-player-shadow-root-intermediary"),this._f.appendChild(t);const i=this._f.attachShadow?t.attachShadow({mode:"open"}):t,s=this.tp.createElement("style");s.textContent=':host{all:initial;color:initial}.story-player-iframe{height:100%;width:100%;-ms-flex:0 0 100%;flex:0 0 100%;border:0;opacity:0;transition:opacity 500ms ease;position:absolute}.i-amphtml-story-player-main-container{height:100%;position:relative;overflow:hidden;transform-style:preserve-3d}.i-amphtml-story-player-loaded .story-player-iframe{opacity:1;transition:transform 200ms cubic-bezier(0.4,0,0.2,1)}.i-amphtml-story-player-no-navigation-transition .story-player-iframe{transition-duration:0.01s}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="0"],.i-amphtml-story-player-main-container iframe:first-of-type{transform:translateZ(1px)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="1"],.i-amphtml-story-player-main-container iframe:nth-of-type(2),.i-amphtml-story-player-main-container iframe:nth-of-type(3){transform:translate3d(100%,0,0)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="-1"]{transform:translate3d(-100%,0,0)}.amp-story-player-exit-control-button{position:absolute;height:48px;width:48px;background-repeat:no-repeat;background-position:50%;margin-top:7px;background-size:28px;border:0px;background-color:transparent;outline:transparent;cursor:pointer;z-index:1}.amp-story-player-close-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\')}.amp-story-player-back-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>\')}.amp-story-player-hide-button{display:none}.i-amphtml-story-player-panel{--i-amphtml-story-player-panel-ratio:69/116;--i-amphtml-story-player-panel-responsive-margin:max(74px,calc(var(--i-amphtml-story-player-height)*0.0825));--i-amphtml-story-player-panel-height:calc(var(--i-amphtml-story-player-height) - var(--i-amphtml-story-player-panel-responsive-margin)*2);--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-panel-height)*var(--i-amphtml-story-player-panel-ratio));--i-amphtml-story-player-panel-button-margin:max(10px,calc(50vw - 145px - var(--i-amphtml-story-player-panel-width)/2))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-medium{--i-amphtml-story-player-panel-responsive-margin:0px;--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-height)*var(--i-amphtml-story-player-panel-ratio))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-small{--i-amphtml-story-player-panel-ratio:36/53}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{position:absolute;top:50%;transform:translateY(-50%);width:48px;height:48px;z-index:1;background-color:transparent;border:none;background-position:50%;background-repeat:no-repeat;cursor:pointer;transition:opacity 150ms}.i-amphtml-story-player-panel-next[disabled],.i-amphtml-story-player-panel-prev[disabled]{opacity:.1;cursor:initial}.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-next,.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-prev,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-next,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-prev{opacity:0;pointer-events:none}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><path stroke="%23fff" stroke-linecap="round" stroke-width="1.9" d="M17 29.2V18.8c0-1.2 1.4-2 2.5-1.3l7.5 5.2c1 .6 1 2 0 2.6l-7.5 5.2c-1 .7-2.5 0-2.5-1.3z"/><rect width="1.8" height="15.6" x="30.2" y="16.2" fill="%23fff" rx=".9"/></svg>\')!important}.i-amphtml-story-player-panel-prev{margin-inline-start:calc(var(--i-amphtml-story-player-panel-button-margin));transform:translateY(-50%) rotate(180deg)}.i-amphtml-story-player-panel-next{margin-inline-end:var(--i-amphtml-story-player-panel-button-margin);right:0}[dir=rtl].i-amphtml-story-player-panel-prev{right:0}[dir=rtl].i-amphtml-story-player-panel-next{left:0;transform:translateY(-50%) rotate(180deg)}\n/*# sourceURL=/css/amp-story-player-shadow.css*/',i.appendChild(s),i.insertBefore(this.ep,i.firstElementChild)}Fp(){const t=this._f.getAttribute("exit-control");if("back-button"!==(i=t)&&"close-button"!==i)return;var i;const s=this.tp.createElement("button");this.ep.appendChild(s);const e="back-button"===t;s.classList.add(e?"amp-story-player-back-button":"amp-story-player-close-button"),s.classList.add("amp-story-player-exit-control-button"),s.addEventListener("click",(()=>{this._f.dispatchEvent(jt(this.i,e?"amp-story-player-back":"amp-story-player-close",{}))}))}qp(){if(this.dp)return this.dp;const t=this._f.getAttribute("amp-cache");t&&!Xt.includes(t)&&console.error(`[${ti}]`,`Unsupported cache specified, use one of following: ${Xt}`);const i=this._f.querySelector("script");if(!i)return null;if("SCRIPT"!=(s=i).tagName||"APPLICATION/JSON"!=(null===(e=s.getAttribute("type"))||void 0===e?void 0:e.toUpperCase()))throw new Error('<script> child must have type="application/json"');var s,e,n;try{this.dp=(n=i.textContent,JSON.parse(n))}catch(t){console.error(`[${ti}] `,t)}return this.dp}jp(t){const i=this.tp.createElement("iframe");t.posterImage&&Vt(i,"backgroundImage",t.posterImage),i.classList.add("story-player-iframe"),i.setAttribute("allow","autoplay"),function(t){if(!t.sandbox||!t.sandbox.supports)return;const i=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let s=0;s<i.length;s++){const e=i[s];if(!t.sandbox.supports(e))return}t.sandbox=i.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(i),this.Xp(i),this.Bp(i),t.iframe=i}Xp(t){if(t.sandbox&&t.sandbox.supports&&!(t.sandbox.length<=0))for(let i=0;i<Bt.length;i++){const s=Bt[i];if(!t.sandbox.supports(s))throw new Error(`Iframe doesn't support: ${s}`);t.sandbox.add(s)}}Zp(t){const{iframe:i}=t;t.messagingPromise=new Promise((s=>{this.Gp(t,i).then((i=>{i.setDefaultHandler((()=>z())),i.registerHandler("touchstart",((t,i)=>{this.Jp(i)})),i.registerHandler("touchmove",((t,i)=>{this.Wp(i)})),i.registerHandler("touchend",((t,i)=>{this.Qp(i)})),i.registerHandler("selectDocument",((t,i)=>{this.Kp(i)})),i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0})),i.sendRequest("onDocumentState",{"state":Gt},!1),i.sendRequest("onDocumentState",{"state":Qt},!1),i.sendRequest("onDocumentState",{"state":Wt}),i.sendRequest("onDocumentState",{"state":Jt}),i.registerHandler("documentStateUpdate",((t,s)=>{this.tm(s,i)})),this.dp&&this.dp.controls&&(this.im(t.idx),i.sendRequest("customDocumentUI",{"controls":this.dp.controls},!1)),s(i)}),(t=>{console.error(`[${ti}]`,t)}))}))}im(t){if(t===this.fp.length-1){const t=s(this.dp.controls,(t=>"skip-next"===t.name||"skip-to-next"===t.name));t>=0&&(this.dp.controls[t].state="disabled")}}Gp(t,i){return this.sm(t.href).then((t=>bt.waitForHandshakeFromDocument(this.i,i.contentWindow,this.nm(t).origin,null,P)))}Bp(t){this.ep.classList.add(Lt),t.onload=()=>{this.ep.classList.remove(Lt),this.ep.classList.add(Yt),this._f.classList.add(Yt)},t.onerror=()=>{this.ep.classList.remove(Lt),this.ep.classList.add(Ht),this._f.classList.add(Ht)}}layoutPlayer(){if(!this._f.sp){if(new Ot(this.i,this._f,(()=>this.Pp.resolve())),this.i.ResizeObserver)new this.i.ResizeObserver((t=>{const{height:i,width:s}=t[0].contentRect;this.rm(i,s)})).observe(this._f);else{const{height:t,width:i}=this._f.getBoundingClientRect();this.rm(t,i)}this.mo(),this._f.sp=!0}}Yp(){this.Vp=this.tp.createElement("button"),this.Vp.classList.add("i-amphtml-story-player-panel-prev"),this.Vp.addEventListener("click",(()=>this.om())),this.Vp.setAttribute("aria-label","previous story"),this.ep.appendChild(this.Vp),this.Sp=this.tp.createElement("button"),this.Sp.classList.add("i-amphtml-story-player-panel-next"),this.Sp.addEventListener("click",(()=>this.Ce())),this.Sp.setAttribute("aria-label","next story"),this.ep.appendChild(this.Sp),this.am()}am(){xt(this.Vp,"disabled",this.hm(this.pp-1)&&!this._p),xt(this.Sp,"disabled",this.hm(this.pp+1)&&!this._p)}rm(t,i){const s=i/t>.75;this.ep.classList.toggle("i-amphtml-story-player-panel",s),s&&(St(this.ep,{"--i-amphtml-story-player-height":`${t}px`}),this.ep.classList.toggle("i-amphtml-story-player-panel-medium",t<756),this.ep.classList.toggle("i-amphtml-story-player-panel-small",t<538))}lm(){let{endpoint:t}=this.dp.behavior;return t?(t=t.replace(/\${offset}/,this.fp.length.toString()),fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then((t=>t.json())).catch((t=>{console.error(`[${ti}]`,t)}))):(this.yp=!1,z())}show(t,i=null,s={}){const e=this.um(t);let n=z();return e.idx!==this.pp&&(this.pp=e.idx,n=this.mo(),!1===s.animate&&(this.ep.classList.toggle(Kt,!0),function(t,i,s,e){let n=s;const r=function(t,i,s,e){let n=t,r=s,o=t=>{try{return r(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const a=function(){if(void 0!==Rt)return Rt;Rt=!1;try{const t={get capture(){return Rt=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return Rt}();return n.addEventListener(i,o,!!a&&e),()=>{null==n||n.removeEventListener(i,o,!!a&&e),r=null,n=null,o=null}}(t,"transitionend",(t=>{try{n(t)}finally{n=null,r()}}),void 0)}(e.iframe,0,(()=>{this.ep.classList.remove(Kt)}))),this.fm()),null!=i?n.then((()=>this.pm(i))):n}mute(){const t=this.fp[this.pp];this.dm(t,!0)}unmute(){const t=this.fp[this.pp];this.dm(t,!1)}getStoryState(t){"page-attachment"===t&&this.ym()}_m(t){const i=jt(this.i,"navigation",t);this._f.dispatchEvent(i)}fm(){const t=this.pp,i=this.fp.length-this.pp-1,s={"index":t,"remaining":i};this.am(),this.gm().then((t=>this.vm(t))),this._m(s),this.Up(i)}gm(){const t=this.fp[this.pp];return new Promise((i=>{t.messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Jt},!0).then((t=>i(t.value)))}))}))}vm(t){const i=2===t||0===t;this.ep.classList.toggle("i-amphtml-story-player-full-bleed-story",i)}Up(t){this.dp&&this.dp.behavior&&this.Pm()&&t<=2&&this.lm().then((t=>{t&&this.add(t)})).catch((t=>{console.error(`[${ti}]`,t)}))}Am(t){return t&&t.on&&t.action}Pm(){if(null!==this.yp)return this.yp;const{behavior:t}=this.dp;var i;return this.yp=this.Am(t)&&"end"===(i=t).on&&"fetch"===i.action&&i.endpoint,this.yp}Ce(){!this._p&&this.hm(this.pp+1)||(this._p&&this.hm(this.pp+1)?this.go(1):(this.pp++,this.mo(),this.fm()))}om(){!this._p&&this.hm(this.pp-1)||(this._p&&this.hm(this.pp-1)?this.go(-1):(this.pp--,this.mo(),this.fm()))}go(t,i=0,s={}){if(0===t&&0===i)return;if(!this._p&&this.hm(this.pp+t))throw new Error("Out of Story range.");const e=this.pp+t,n=t>0?this.fp[e%this.fp.length]:this.fp[(e%this.fp.length+this.fp.length)%this.fp.length];let r=z();this.pp!==n.idx&&(r=this.show(n.href,null,s)),r.then((()=>{this.bm(i)}))}wm(t){const i=0===t.distance?0:t.idx>this.pp?1:-1;requestAnimationFrame((()=>{const{iframe:s}=t;kt(s,["transform","transition"]),s.setAttribute("i-amphtml-iframe-position",i)}))}Em(t){var i;return this.fp[this.pp].storyContentLoaded?z():0!==t.distance?this.vp.promise:(null===(i=this.vp)||void 0===i||i.reject("[amp-story-player-dev] Cancelling previous story load promise."),this.vp=new O,t.messagingPromise.then((i=>i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0,this.vp.resolve()})))),z())}mo(t=this.pp){const i=[];for(let s=0;s<this.fp.length;s++){const e=this.fp[(s+t)%this.fp.length],n=e.distance;e.distance=Math.abs(this.pp-e.idx),n<=1&&e.distance>1&&this.Mm(e),e.distance<=1&&!e.iframe.isConnected&&this.Tm(e),e.distance>1||i.push(this.Em(e).then((()=>this.sm(e.href))).then((t=>{this.xm(t,e.iframe.src)||this.Rm(e,t)})).then((()=>this.Pp.promise)).then((()=>{0===e.distance&&this.Rp&&this.ei(e,Mt),0===n&&1===e.distance&&this.ei(e,"inactive")})).then((()=>{this.wm(e),0===e.distance&&Tt(e.iframe)})).catch((t=>{t.includes("amp-story-player-dev")||console.error(`[${ti}]`,t)})))}return Promise.all(i)}Tm(t){this.ep.appendChild(t.iframe),this.Zp(t),t.connectedDeferred.resolve()}Mm(t){t.storyContentLoaded=!1,t.connectedDeferred=new O,t.iframe.setAttribute("src",""),t.iframe.remove()}Rm(t,i){const{iframe:s}=t,{href:e}=this.nm(i,"prerender");s.setAttribute("src",e),t.title&&s.setAttribute("title",t.title)}xm(t,i){return!(i.length<=0)&&Ut(Nt(i))===Ut(Nt(t))}sm(t){const i=this._f.getAttribute("amp-cache");if(!i||!Xt.includes(i))return Promise.resolve(t);if(Dt(t)){const i=$t(t);return i.pathname.startsWith("/c/")&&(i.pathname="/v/"+i.pathname.substr(3)),Promise.resolve(i.toString())}return _t(i,t,"viewer").then((t=>t))}nm(t,i="inactive"){const s={"visibilityState":i,"origin":this.i.origin,"showStoryUrlInfo":"0","storyPlayer":"v0","cap":"swipe"};"auto"===this.Ip&&(s.attribution="auto");const e=q(q({},g(Ct(t))),s);let n=Ut(t);Dt(t)&&(n=function(t,i,s){if(!i)return t;const e=t.split("#",2),n=e[0].split("?",2);let r=n[0]+(n[1]?`?${n[1]}&${i}`:`?${i}`);return r+=e[1]?`#${e[1]}`:"",r}(n,qt({"amp_js_v":"0.1"})));const r=n+"#"+qt(e);return Ft(this.up,r)}ei(t,i){t.messagingPromise.then((t=>t.sendRequest("visibilitychange",{state:i},!0)))}Im(t,i,s){t.messagingPromise.then((t=>{t.sendRequest("setDocumentState",{state:i,value:s})}))}dm(t,i){this.Im(t,Wt,i)}ym(){this.fp[this.pp].messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Gt},!0).then((t=>this.Vm(t.value)))}))}pm(t){this.fp[this.pp].messagingPromise.then((i=>i.sendRequest("selectPage",{"id":t})))}um(t){const i=t?s(this.fp,(({href:i})=>i===t)):this.pp;if(!this.fp[i])throw new Error(`Story URL not found in the player: ${t}`);return this.fp[i]}rewind(t){const i=this.um(t);this.Sm(i).then((()=>i.messagingPromise)).then((t=>t.sendRequest("rewind",{})))}Sm(t){return t.iframe.isConnected?z():t.connectedDeferred.promise}bm(t){0!==t&&this.km(t)}km(t){this.fp[this.pp].messagingPromise.then((i=>i.sendRequest("selectPage",{delta:t})))}tm(t,i){switch(t.state){case Gt:this.jm(t.value);break;case Qt:this.zm(t.value,i);break;case Wt:this.Om(t.value);break;case Jt:this.vm(t.value);break;case"AMP_STORY_PLAYER_EVENT":this.$m(t.value)}}$m(t){switch(t){case"amp-story-player-skip-next":case"amp-story-player-skip-to-next":this.Ce();break;default:this._f.dispatchEvent(jt(this.i,t,{}))}}Om(t){this._f.dispatchEvent(jt(this.i,"amp-story-muted-state",{muted:t}))}zm(t,i){i.sendRequest("getDocumentState",{"state":"STORY_PROGRESS"},!0).then((i=>{this._f.dispatchEvent(jt(this.i,"storyNavigation",{"pageId":t,"progress":i.value}))}))}jm(t){this.Fm(!t),this.Vm(t)}Fm(t){const i=this.ep.querySelector("button.amp-story-player-exit-control-button");i&&(t?i.classList.remove(Zt):i.classList.add(Zt))}Vm(t){this._f.dispatchEvent(jt(this.i,t?"page-attachment-open":"page-attachment-close",{}))}Kp(t){this.qm(t),t.next?this.Ce():t.previous&&this.om()}qm(t){if(this._p||!t.next&&!t.previous)return;let i,s;t.next?(i=this.pp+1===this.fp.length,s="noNextStory"):(i=0===this.pp,s="noPreviousStory"),i&&this._f.dispatchEvent(jt(this.i,s,{}))}Jp(t){const i=this.Um(t);i&&(this.gp.startX=i.screenX,this.gp.startY=i.screenY,this.bp&&this.bp.onTouchStart(t.timeStamp,i.clientY),this._f.dispatchEvent(jt(this.i,"amp-story-player-touchstart",{"touches":t.touches})))}Wp(t){const i=this.Um(t);if(!i)return;if(this._f.dispatchEvent(jt(this.i,"amp-story-player-touchmove",{"touches":t.touches,"isNavigationalSwipe":this.gp.isSwipeX})),!1===this.gp.isSwipeX)return void(this.bp&&this.bp.onTouchMove(t.timeStamp,i.clientY));const{screenX:s,screenY:e}=i;this.gp.lastX=s,(null!==this.gp.isSwipeX||(this.gp.isSwipeX=Math.abs(this.gp.startX-s)>Math.abs(this.gp.startY-e),this.gp.isSwipeX))&&this.Cm({deltaX:s-this.gp.startX,last:!1})}Qp(t){this._f.dispatchEvent(jt(this.i,"amp-story-player-touchend",{"touches":t.touches,"isNavigationalSwipe":this.gp.isSwipeX})),!0===this.gp.isSwipeX?this.Cm({deltaX:this.gp.lastX-this.gp.startX,last:!0}):this.bp&&this.bp.onTouchEnd(t.timeStamp),this.gp.startX=0,this.gp.startY=0,this.gp.lastX=0,this.gp.isSwipeX=null,this.mp=0}Cm(t){if(this.fp.length<=1)return;const{deltaX:i}=t;if(!0===t.last){const t=Math.abs(i);return 1===this.mp&&(t>50&&(this.Dm()||this._p)?this.Ce():this.Nm()),void(2===this.mp&&(t>50&&(this.Dm()||this._p)?this.om():this.Nm()))}this.Lm(i)}Nm(){const t=this.fp[this.pp].iframe;requestAnimationFrame((()=>{kt(wt(t),["transform","transition"])}));const i=this.Dm();i&&requestAnimationFrame((()=>{kt(wt(i.iframe),["transform","transition"])}))}Dm(){const t=1===this.mp?this.pp+1:this.pp-1;return this.hm(t)?null:this.fp[t]}hm(t){return t>=this.fp.length||t<0}Cp(){if(!this.dp)return;const{behavior:t}=this.dp;t&&"boolean"==typeof t.autoplay&&(this.Rp=t.autoplay)}Dp(){if(!this.dp)return;const{display:t}=this.dp;t&&"auto"===t.attribution&&(this.Ip="auto")}Np(){if(!this.dp)return;const{behavior:t}=this.dp;t&&!1===t.pageScroll&&(this.bp=null)}Lp(){if(null!==this._p)return this._p;if(!this.dp)return this._p=!1,!1;const{behavior:t}=this.dp;var i;return this._p=this.Am(t)&&"end"===(i=t).on&&"circular-wrapping"===i.action,this._p}Lm(t){let i;t<0?(this.mp=1,i=`translate3d(calc(100% + ${t}px), 0, 0)`):(this.mp=2,i=`translate3d(calc(${t}px - 100%), 0, 0)`);const s=this.fp[this.pp],{iframe:e}=s,n=`translate3d(${t}px, 0, 0)`;requestAnimationFrame((()=>{St(wt(e),{transform:n,transition:"none"})}));const r=this.Dm();r&&requestAnimationFrame((()=>{St(wt(r.iframe),{transform:i,transition:"none"})}))}Um(t){const{touches:i}=t;if(!i||i.length<1)return null;const{clientX:s,clientY:e,screenX:n,screenY:r}=i[0];return{screenX:n,screenY:r,clientX:s,clientY:e}}};(function(t,i,s){let e=i(t);if(e)s();else{const n=()=>{i(t)&&(e||(e=!0,s()),t.removeEventListener("readystatechange",n))};t.addEventListener("readystatechange",n)}})(self.document,(function(t){return"loading"!=t.readyState&&"uninitialized"!=t.readyState}),(()=>{new class{constructor(t){this.i=t}Ym(t){new Ot(this.i,t,(()=>t.layoutPlayer()));const i=()=>{t.layoutPlayer(),this.i.removeEventListener("scroll",i)};this.i.addEventListener("scroll",i)}loadPlayers(){const t=this.i.document.getElementsByTagName("amp-story-player");I();for(let i=0;i<t.length;i++){const s=t[i],e=new ii(this.i,s);e.buildPlayer(),this.Ym(e)}}loadEntryPoints(){const t=this.i.document.getElementsByTagName("amp-story-entry-point");I();for(let i=0;i<t.length;i++){const s=t[i],e=new j(this.i,s);e.buildCallback(),this.Ym(e)}}}(self).loadPlayers()})),globalThis.AmpStoryPlayer=ii})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=amp-story-player-v0.mjs.map